<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8"/>
    <title>HTBAH</title>
    <link rel="stylesheet" type="text/css" href="bulma.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
    <script src="jquery.js"></script>
    <style>
        html, body {
            height: 100vh;
            background: #ECF0F3;
        }

        .on-row {
            background-color: lightgreen !important;
        }

        #wrapper {
            margin: 10px 10px 0;
            height: 100%;
            max-width: calc(100% - 20px);
            width: calc(100% - 20px);
        }

        #loader {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 100000;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
        }

        #ld-holder {
            position: absolute;
            width: 80px;
            height: 80px;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        .lds-ellipsis {
            display: inline-block;
            position: relative;
            width: 80px;
            height: 80px;
        }

        .lds-ellipsis div {
            position: absolute;
            top: 33px;
            width: 13px;
            height: 13px;
            border-radius: 50%;
            background: #dfc;
            animation-timing-function: cubic-bezier(0, 1, 1, 0);
        }

        .lds-ellipsis div:nth-child(1) {
            left: 8px;
            animation: lds-ellipsis1 0.6s infinite;
        }

        .lds-ellipsis div:nth-child(2) {
            left: 8px;
            animation: lds-ellipsis2 0.6s infinite;
        }

        .lds-ellipsis div:nth-child(3) {
            left: 32px;
            animation: lds-ellipsis2 0.6s infinite;
        }

        .lds-ellipsis div:nth-child(4) {
            left: 56px;
            animation: lds-ellipsis3 0.6s infinite;
        }

        @keyframes lds-ellipsis1 {
            0% {
                transform: scale(0);
            }
            100% {
                transform: scale(1);
            }
        }

        @keyframes lds-ellipsis3 {
            0% {
                transform: scale(1);
            }
            100% {
                transform: scale(0);
            }
        }

        @keyframes lds-ellipsis2 {
            0% {
                transform: translate(0, 0);
            }
            100% {
                transform: translate(24px, 0);
            }
        }
    </style>
</head>
<body>
<div class="container" id="wrapper">
    <div class="columns" style="margin-left: 10px">
        <div class="column is-3 ">
            <aside class="menu is-hidden-mobile">
                <p class="menu-label">
                    How to be a Helper
                </p>
                <ul class="menu-list">
                    <li><a class="page-switch" data-page="dashboard">Dashboard</a></li>
                    <li><a class="page-switch" data-page="char-editor">Charakter-Editor</a></li>
                    <li><a class="page-switch" data-page="settings">Einstellungen</a></li>
                    <li><a class="page-switch" data-page="about">Über das Tool</a></li>
                </ul>
                <p class="menu-label" id="sessions-list-title">
                    Sessions <a class="tag is-primary" id="sessions-list-actions">+</a>
                </p>
                <ul class="menu-list" id="sessions-list">

                </ul>
                <p class="menu-label">
                    Plugins
                </p>
                <ul class="menu-list">

                </ul>
            </aside>
        </div>
        <div class="column is-9" style="padding-top: 25px">
            <div id="page-sessions-actions" class="container" style="display: none">
                <div class="columns is-centered">
                    <div class="column is-6">
                        <div class="card">
                            <header class="card-header">
                                <p class="card-header-title">
                                    Einer Session beitreten
                                </p>
                            </header>
                            <div class="card-content">
                                <div class="field">
                                    <label class="label">Session-ID:</label>
                                    <div class="control has-icons-left has-icons-right">
                                        <input class="input" type="text" placeholder="Session-ID eingeben"
                                               id="session-join-id" required>
                                        <span class="icon is-small is-left">
                                          <i class="fas fa-key"></i>
                                        </span>
                                    </div>
                                    <p class="help is-danger" id="session-join-id-fail" style="display: none">Eine
                                        Session mit dieser ID existiert nicht!</p>
                                </div>
                                <div class="field">
                                    <label class="label">Passwort:</label>
                                    <div class="control has-icons-left has-icons-right">
                                        <input class="input" type="password" placeholder="Passwort eingeben"
                                               id="session-join-password" required>
                                        <span class="icon is-small is-left">
                                          <i class="fas fa-lock"></i>
                                        </span>
                                    </div>
                                    <p class="help is-danger" id="session-join-password-fail" style="display: none">Das
                                        Session-Passwort ist falsch!</p>
                                </div>
                            </div>
                            <footer class="card-footer">
                                <a href="#" class="card-footer-item" id="session-join" onclick="joinSession()">Session
                                    beitreten</a>
                            </footer>
                        </div>
                        <div class="card" style="margin-top: 25px">
                            <header class="card-header">
                                <p class="card-header-title">
                                    Eine Session erstellen
                                </p>
                            </header>
                            <div class="card-content">
                                <div class="field">
                                    <label class="label">Spiel-Name:</label>
                                    <div class="control has-icons-left has-icons-right">
                                        <input class="input" type="text" placeholder="Spiel-Name eingeben"
                                               id="session-create-name" required>
                                        <span class="icon is-small is-left">
                                          <i class="fas fa-key"></i>
                                        </span>
                                    </div>
                                </div>
                                <div class="field">
                                    <label class="label">Passwort:</label>
                                    <div class="control has-icons-left has-icons-right">
                                        <input class="input" type="password" placeholder="Passwort eingeben"
                                               id="session-create-password" required>
                                        <span class="icon is-small is-left">
                                          <i class="fas fa-lock"></i>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <footer class="card-footer">
                                <a href="#" class="card-footer-item" id="session-create" onclick="createSession()">Session
                                    erstellen</a>
                            </footer>
                        </div>
                    </div>
                </div>
            </div>
            <div id="page-register" class="container" style="display: none">
                <div class="columns is-centered">
                    <div class="column is-6">
                        <div class="card">
                            <header class="card-header">
                                <p class="card-header-title">
                                    Erstelle dein Account!
                                </p>
                            </header>
                            <div class="card-content">
                                <div class="field">
                                    <label class="label">Benutzername:</label>
                                    <div class="control has-icons-left has-icons-right">
                                        <input class="input" type="text" placeholder="Benutzername eingeben"
                                               id="register-name" required>
                                        <span class="icon is-small is-left">
                                          <i class="fas fa-user"></i>
                                        </span>
                                        <span class="icon is-small is-right">
                                          <i class="" id="register-name-icon"></i>
                                        </span>
                                    </div>
                                    <p class="help is-danger" id="register-name-fail" style="display: none">Der
                                        Benutzername existiert
                                        bereits!</p>
                                </div>
                                <div class="field">
                                    <label class="label">Passwort:</label>
                                    <div class="control has-icons-left has-icons-right">
                                        <input class="input" type="password" placeholder="Passwort eingeben"
                                               id="register-password" required>
                                        <span class="icon is-small is-left">
                                          <i class="fas fa-key"></i>
                                        </span>
                                    </div>
                                </div>
                                <div class="field">
                                    <label class="label">Passwort wiederholen:</label>
                                    <div class="control has-icons-left has-icons-right">
                                        <input class="input" type="password" placeholder="Passwort wiederholen"
                                               id="register-password-repeat" required>
                                        <span class="icon is-small is-left">
                                          <i class="fas fa-key"></i>
                                        </span>
                                    </div>
                                    <p class="help is-danger" id="register-password-failed" style="display: none">Die
                                        Passwörter stimmen nicht überein!</p>
                                </div>
                            </div>
                            <footer class="card-footer">
                                <a href="#" class="card-footer-item" onclick="showRegisterAdvantages()">Deine
                                    Vorteile</a>
                                <a href="#" class="card-footer-item" id="register-finish" onclick="finishRegister()">Account
                                    erstellen</a>
                            </footer>
                        </div>
                    </div>
                </div>
            </div>
            <div id="page-login" class="container" style="display: none">
                <div class="columns is-centered">
                    <div class="column is-6">
                        <div class="card">
                            <header class="card-header">
                                <p class="card-header-title">
                                    Logge dich ein!
                                </p>
                            </header>
                            <div class="card-content">
                                <div class="field">
                                    <label class="label">Benutzername:</label>
                                    <div class="control has-icons-left has-icons-right">
                                        <input class="input" type="text" placeholder="Benutzername eingeben"
                                               id="login-name" required>
                                        <span class="icon is-small is-left">
                                          <i class="fas fa-user"></i>
                                        </span>
                                    </div>
                                </div>
                                <div class="field">
                                    <label class="label">Passwort:</label>
                                    <div class="control has-icons-left has-icons-right">
                                        <input class="input" type="password" placeholder="Passwort eingeben"
                                               id="login-password" required>
                                        <span class="icon is-small is-left">
                                          <i class="fas fa-key"></i>
                                        </span>
                                    </div>
                                </div>
                                <div class="field">
                                    <div class="control">
                                        <label class="checkbox">
                                            <input type="checkbox" id="login-save"> Daten merken
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <footer class="card-footer">
                                <a href="#" class="card-footer-item" id="login-finish"
                                   onclick="finishLogin()">Einloggen</a>
                            </footer>
                        </div>
                    </div>
                </div>
            </div>
            <div id="page-dashboard">
                <section id="login-message" class="hero is-warning welcome is-small" style="display: none">
                    <div class="hero-body">
                        <div class="container">
                            <h1 class="title">
                                Hey!
                            </h1>
                            <div class="subtitle">
                                Es scheint so, dass du nicht eingeloggt bist. Login dich doch <a href="#"
                                                                                                 onclick="showLoginPage()"><b>hier</b></a>
                                ein!
                                <br><br>
                                Hast du noch kein Account? Erstelle dir doch <a href="#"
                                                                                onclick="showRegisterPage()"><b>hier</b></a>
                                einen. Dadurch erhälst
                                du
                                einige
                                Vorteile!
                            </div>
                        </div>
                    </div>
                </section>
                <div class="columns is-centered">
                    <div class="column">
                        <div class="card events-card">
                            <header class="card-header">
                                <p class="card-header-title">
                                    Deine Charaktere
                                </p>
                            </header>
                            <div class="card-table">
                                <div class="content">
                                    <br>
                                    <div id="dashboard-remote-char-pack">
                                        <div class="columns is-centered is-gapless" style="margin-bottom: 0">
                                            <div class="column" style="margin-bottom: 0">
                                                <hr style="margin-bottom: 0">
                                            </div>
                                            <div class="column is-2 has-text-centered">
                                                <h4 class="subtitle is-4 has-text-centered">Cloud</h4>
                                            </div>
                                            <div class="column" style="margin-bottom: 0">
                                                <hr style="margin-bottom: 0">
                                            </div>
                                        </div>
                                        <table class="table is-fullwidth is-striped">
                                            <tbody id="dashboard-remote-chars">
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="columns is-centered is-gapless" style="margin-bottom: 0">
                                        <div class="column" style="margin-bottom: 0">
                                            <hr style="margin-bottom: 0">
                                        </div>
                                        <div class="column is-2 has-text-centered">
                                            <h4 class="subtitle is-4 has-text-centered">Lokal</h4>
                                        </div>
                                        <div class="column" style="margin-bottom: 0">
                                            <hr style="margin-bottom: 0">
                                        </div>
                                    </div>
                                    <table class="table is-fullwidth is-striped">
                                        <tbody id="dashboard-local-chars">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <footer class="card-footer">
                                <a href="#" class="card-footer-item" id="refresh-characters">Aktualisieren</a>
                            </footer>
                        </div>
                    </div>
                </div>
            </div>
            <div id="page-char-editor" style="display: none">
                <div class="columns is-centered">
                    <div class="column">
                        <div class="card events-card">
                            <header class="card-header">
                                <p class="card-header-title">
                                    Charakter-Editor
                                </p>
                            </header>
                            <div class="card-table">
                                <div class="card-content">
                                    <div class="field">
                                        <div class="field-body">
                                            <div class="field">
                                                <label class="label">Name:</label>
                                                <div class="control">
                                                    <input class="input" type="text" placeholder="Name eingeben"
                                                           required id="editor-name">
                                                </div>
                                            </div>
                                            <div class="field">
                                                <label class="label">Geschlecht:</label>
                                                <div class="control">
                                                    <div class="select is-fullwidth">
                                                        <select id="editor-gender">
                                                            <option value="def">--AUSWÄHLEN--</option>
                                                            <option value="divers">divers</option>
                                                            <option value="männlich">männlich</option>
                                                            <option value="weiblich">weiblich</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <div class="field-body">
                                            <div class="field">
                                                <label class="label">Alter:</label>
                                                <div class="control">
                                                    <input class="input" type="number" placeholder="Alter eingeben"
                                                           min="0" max="1000000000"
                                                           required id="editor-age">
                                                </div>
                                            </div>
                                            <div class="field">
                                                <label class="label">Statur:</label>
                                                <div class="control">
                                                    <input class="input" type="text" placeholder="Statur eingeben"
                                                           required id="editor-stature">
                                                </div>
                                            </div>
                                            <div class="field">
                                                <label class="label">Religion:</label>
                                                <div class="control">
                                                    <input class="input" type="text" placeholder="Religion eingeben"
                                                           required id="editor-religion">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <div class="field-body">
                                            <div class="field">
                                                <label class="label">Beruf:</label>
                                                <div class="control">
                                                    <input class="input" type="text" placeholder="Beruf eingeben"
                                                           required id="editor-job">
                                                </div>
                                            </div>
                                            <div class="field">
                                                <label class="label">Familienstand:</label>
                                                <div class="control">
                                                    <div class="select is-fullwidth">
                                                        <select id="editor-martialstatus">
                                                            <option value="ledig">ledig</option>
                                                            <option value="verheiratet">verheiratet</option>
                                                            <option value="verwitwet">verwitwet</option>
                                                            <option value="geschieden">geschieden</option>
                                                            <option value="Ehe aufgehoben">Ehe aufgehoben</option>
                                                            <option value="in eingetragener Lebenspartnerschaft">in
                                                                eingetragener Lebenspartnerschaft
                                                            </option>
                                                            <option value="durch Tod aufgelöste Lebenspartnerschaft">
                                                                durch Tod aufgelöste Lebenspartnerschaft
                                                            </option>
                                                            <option value="aufgehobene Lebenspartnerschaft">aufgehobene
                                                                Lebenspartnerschaft
                                                            </option>
                                                            <option value="durch Todeserklärung aufgelöste Lebenspartnerschaft">
                                                                durch Todeserklärung aufgelöste
                                                                Lebenspartnerschaft
                                                            </option>
                                                            <option value="nicht bekannt">nicht bekannt</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <hr>
                                    <div class="field">
                                        <div class="field-body">
                                            <div class="field is-expanded">
                                                <h3 class="title is-3" style="font-size: 20px; margin-bottom: 10px">
                                                    Fertigkeiten:</h3>
                                            </div>
                                            <div class="field">
                                                <div class="field-body">
                                                    <div class="field">
                                                        <label class="label">Punkte gegeben:</label>
                                                        <div class="control">
                                                            <input class="input" type="number" value="400"
                                                                   placeholder=""
                                                                   id="editor-points">
                                                        </div>
                                                    </div>
                                                    <div class="field">
                                                        <label class="label">Punkte übrig:</label>
                                                        <div class="control">
                                                            <input class="input" type="number" value="400"
                                                                   placeholder="" readonly
                                                                   id="editor-points-left">
                                                        </div>
                                                    </div>
                                                    <div class="field">
                                                        <label class="label">Punkte aktualisieren:</label>
                                                        <div class="control">
                                                            <button class="button is-warning"
                                                                    id="editor-points-refresh">Forcieren
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <div class="field-body">
                                            <div class="field" style="max-width: 280px">
                                                <label class="label">Handeln: <i id="editor-actSkills-bonus">0</i> (<i
                                                        id="editor-actSkills-brainstorm">0</i>)</label>
                                                <div class="control">
                                                    <div class="field" id="editor-skils-act">
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-actSkills-0-name"
                                                                               onchange="onEditorSkillsNameChange('editor-actSkills-0-name', 'actSkills', 0)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-actSkills-0-name', 'actSkills', 0)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-actSkills-0-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-actSkills-0-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-actSkills-1-name"
                                                                               onchange="onEditorSkillsNameChange('editor-actSkills-1-name', 'actSkills', 1)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-actSkills-1-name', 'actSkills', 1)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-actSkills-1-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-actSkills-1-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-actSkills-2-name"
                                                                               onchange="onEditorSkillsNameChange('editor-actSkills-2-name', 'actSkills', 2)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-actSkills-2-name', 'actSkills', 2)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-actSkills-2-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-actSkills-2-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-actSkills-3-name"
                                                                               onchange="onEditorSkillsNameChange('editor-actSkills-3-name', 'actSkills', 3)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-actSkills-3-name', 'actSkills', 3)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-actSkills-3-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-actSkills-3-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-actSkills-4-name"
                                                                               onchange="onEditorSkillsNameChange('editor-actSkills-4-name', 'actSkills', 4)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-actSkills-4-name', 'actSkills', 4)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-actSkills-4-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-actSkills-4-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-actSkills-5-name"
                                                                               onchange="onEditorSkillsNameChange('editor-actSkills-5-name', 'actSkills', 5)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-actSkills-5-name', 'actSkills', 5)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-actSkills-5-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-actSkills-5-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-actSkills-6-name"
                                                                               onchange="onEditorSkillsNameChange('editor-actSkills-6-name', 'actSkills', 6)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-actSkills-6-name', 'actSkills', 6)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-actSkills-6-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-actSkills-6-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-actSkills-7-name"
                                                                               onchange="onEditorSkillsNameChange('editor-actSkills-7-name', 'actSkills', 7)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-actSkills-7-name', 'actSkills', 7)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-actSkills-7-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-actSkills-7-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-actSkills-8-name"
                                                                               onchange="onEditorSkillsNameChange('editor-actSkills-8-name', 'actSkills', 8)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-actSkills-8-name', 'actSkills', 8)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-actSkills-8-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-actSkills-8-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-actSkills-9-name"
                                                                               onchange="onEditorSkillsNameChange('editor-actSkills-9-name', 'actSkills', 9)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-actSkills-9-name', 'actSkills', 9)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-actSkills-9-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-actSkills-9-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="field" style="max-width: 280px">
                                                <label class="label">Wissen: <i id="editor-knowledgeSkills-bonus">0</i>
                                                    (<i id="editor-knowledgeSkills-brainstorm">0</i>)</label>
                                                <div class="control">
                                                    <div class="field" id="editor-skils-knowledge">
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-knowledgeSkills-0-name"
                                                                               onchange="onEditorSkillsNameChange('editor-knowledgeSkills-0-name', 'knowledgeSkills', 0)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-knowledgeSkills-0-name', 'knowledgeSkills', 0)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-knowledgeSkills-0-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-knowledgeSkills-0-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-knowledgeSkills-1-name"
                                                                               onchange="onEditorSkillsNameChange('editor-knowledgeSkills-1-name', 'knowledgeSkills', 1)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-knowledgeSkills-1-name', 'knowledgeSkills', 1)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-knowledgeSkills-1-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-knowledgeSkills-1-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-knowledgeSkills-2-name"
                                                                               onchange="onEditorSkillsNameChange('editor-knowledgeSkills-2-name', 'knowledgeSkills', 2)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-knowledgeSkills-2-name', 'knowledgeSkills', 2)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-knowledgeSkills-2-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-knowledgeSkills-2-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-knowledgeSkills-3-name"
                                                                               onchange="onEditorSkillsNameChange('editor-knowledgeSkills-3-name', 'knowledgeSkills', 3)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-knowledgeSkills-3-name', 'knowledgeSkills', 3)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-knowledgeSkills-3-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-knowledgeSkills-3-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-knowledgeSkills-4-name"
                                                                               onchange="onEditorSkillsNameChange('editor-knowledgeSkills-4-name', 'knowledgeSkills', 4)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-knowledgeSkills-4-name', 'knowledgeSkills', 4)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-knowledgeSkills-4-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-knowledgeSkills-4-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-knowledgeSkills-5-name"
                                                                               onchange="onEditorSkillsNameChange('editor-knowledgeSkills-5-name', 'knowledgeSkills', 5)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-knowledgeSkills-5-name', 'knowledgeSkills', 5)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-knowledgeSkills-5-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-knowledgeSkills-5-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-knowledgeSkills-6-name"
                                                                               onchange="onEditorSkillsNameChange('editor-knowledgeSkills-6-name', 'knowledgeSkills', 6)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-knowledgeSkills-6-name', 'knowledgeSkills', 6)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-knowledgeSkills-6-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-knowledgeSkills-6-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-knowledgeSkills-7-name"
                                                                               onchange="onEditorSkillsNameChange('editor-knowledgeSkills-7-name', 'knowledgeSkills', 7)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-knowledgeSkills-7-name', 'knowledgeSkills', 7)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-knowledgeSkills-7-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-knowledgeSkills-7-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-knowledgeSkills-8-name"
                                                                               onchange="onEditorSkillsNameChange('editor-knowledgeSkills-8-name', 'knowledgeSkills', 8)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-knowledgeSkills-8-name', 'knowledgeSkills', 8)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-knowledgeSkills-8-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-knowledgeSkills-8-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-knowledgeSkills-9-name"
                                                                               onchange="onEditorSkillsNameChange('editor-knowledgeSkills-9-name', 'knowledgeSkills', 9)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-knowledgeSkills-9-name', 'knowledgeSkills', 9)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-knowledgeSkills-9-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-knowledgeSkills-9-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="field" style="max-width: 280px">
                                                <label class="label">Soziales: <i id="editor-socialSkills-bonus">0</i> (<i
                                                        id="editor-socialSkills-brainstorm">0</i>)</label>
                                                <div class="control">
                                                    <div class="field" id="editor-skils-social">
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-socialSkills-0-name"
                                                                               onchange="onEditorSkillsNameChange('editor-socialSkills-0-name', 'socialSkills', 0)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-socialSkills-0-name', 'socialSkills', 0)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-socialSkills-0-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-socialSkills-0-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-socialSkills-1-name"
                                                                               onchange="onEditorSkillsNameChange('editor-socialSkills-1-name', 'socialSkills', 1)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-socialSkills-1-name', 'socialSkills', 1)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-socialSkills-1-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-socialSkills-1-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-socialSkills-2-name"
                                                                               onchange="onEditorSkillsNameChange('editor-socialSkills-2-name', 'socialSkills', 2)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-socialSkills-2-name', 'socialSkills', 2)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-socialSkills-2-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-socialSkills-2-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-socialSkills-3-name"
                                                                               onchange="onEditorSkillsNameChange('editor-socialSkills-3-name', 'socialSkills', 3)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-socialSkills-3-name', 'socialSkills', 3)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-socialSkills-3-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-socialSkills-3-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-socialSkills-4-name"
                                                                               onchange="onEditorSkillsNameChange('editor-socialSkills-4-name', 'socialSkills', 4)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-socialSkills-4-name', 'socialSkills', 4)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-socialSkills-4-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-socialSkills-4-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-socialSkills-5-name"
                                                                               onchange="onEditorSkillsNameChange('editor-socialSkills-5-name', 'socialSkills', 5)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-socialSkills-5-name', 'socialSkills', 5)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-socialSkills-5-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-socialSkills-5-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-socialSkills-6-name"
                                                                               onchange="onEditorSkillsNameChange('editor-socialSkills-6-name', 'socialSkills', 6)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-socialSkills-6-name', 'socialSkills', 6)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-socialSkills-6-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-socialSkills-6-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-socialSkills-7-name"
                                                                               onchange="onEditorSkillsNameChange('editor-socialSkills-7-name', 'socialSkills', 7)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-socialSkills-7-name', 'socialSkills', 7)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-socialSkills-7-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-socialSkills-7-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-socialSkills-8-name"
                                                                               onchange="onEditorSkillsNameChange('editor-socialSkills-8-name', 'socialSkills', 8)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-socialSkills-8-name', 'socialSkills', 8)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-socialSkills-8-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-socialSkills-8-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="editor-socialSkills-9-name"
                                                                               onchange="onEditorSkillsNameChange('editor-socialSkills-9-name', 'socialSkills', 9)"
                                                                               onkeyup="onEditorSkillsNameChange('editor-socialSkills-9-name', 'socialSkills', 9)"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="editor-socialSkills-9-value"
                                                                               value="0" data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="editor-socialSkills-9-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <hr>
                                    <div class="field">
                                        <div class="field-body">
                                            <div class="field">
                                                <label class="label">Inventar:</label>
                                                <div class="control">
                                                    <textarea class="textarea" id="editor-inventory"></textarea>
                                                </div>
                                            </div>
                                            <div class="field">
                                                <label class="label">Anmerkungen:</label>
                                                <div class="control">
                                                    <textarea class="textarea" id="editor-notes"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <footer class="card-footer">
                                <a href="#" class="card-footer-item" onclick="finishCharacter()">Charakter erstellen</a>
                                <a href="#" class="card-footer-item" onclick="resetCharEditor()" style="color: red">Zurücksetzen</a>
                            </footer>
                        </div>
                    </div>
                </div>
            </div>
            <div id="page-char-viewer" style="display: none">
                <div class="columns is-centered">
                    <div class="column">
                        <div class="card events-card">
                            <header class="card-header">
                                <p class="card-header-title">
                                    Charakter-Viewer
                                </p>
                            </header>
                            <div class="card-table">
                                <div class="card-content">
                                    <div class="field">
                                        <div class="message">
                                            <div class="message-body">
                                                <div class="field">
                                                    <div class="field-body">
                                                        <div class="field">
                                                            <label class="label">Leben:</label>
                                                            <div class="control">
                                                                <input class="input editsync" type="number"
                                                                       placeholder="Leben eingeben"
                                                                       id="viewer-health"
                                                                       data-editsync="health">
                                                            </div>
                                                        </div>
                                                        <div class="field" style="max-width: 368px">
                                                            <label class="label">Erfahrungspunkte:</label>
                                                            <div class="control" style="max-width: 368px">
                                                                <div class="columns is-gapless"
                                                                     style="max-width: 368px">
                                                                    <div class="column"
                                                                         style="width: 270px; max-width: 270px">
                                                                        <input class="input editsync" type="number"
                                                                               style="width: 270px; max-width: 270px"
                                                                               placeholder="EXP eingeben"
                                                                               id="viewer-xp" data-editsync="xp">
                                                                    </div>
                                                                    <div class="column is-one-fifth">
                                                                        <button class="button is-success"
                                                                                onclick="levelCharacter()">
                                                                            Aufleveln
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <div class="field-body">
                                            <div class="field">
                                                <label class="label">Name:</label>
                                                <div class="control">
                                                    <input class="input editsync" type="text"
                                                           placeholder="Name eingeben"
                                                           required id="viewer-name" data-editsync="name">
                                                </div>
                                            </div>
                                            <div class="field">
                                                <label class="label">Geschlecht:</label>
                                                <div class="control">
                                                    <div class="select is-fullwidth">
                                                        <select id="viewer-gender" data-editsync="gender"
                                                                class="editsync">
                                                            <option value="divers">divers</option>
                                                            <option value="männlich">männlich</option>
                                                            <option value="weiblich">weiblich</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <div class="field-body">
                                            <div class="field">
                                                <label class="label">Alter:</label>
                                                <div class="control">
                                                    <input class="input editsync" type="number"
                                                           placeholder="Alter eingeben"
                                                           min="0" data-editsync="age" max="1000000000"
                                                           required id="viewer-age">
                                                </div>
                                            </div>
                                            <div class="field">
                                                <label class="label">Statur:</label>
                                                <div class="control">
                                                    <input class="input editsync" type="text"
                                                           placeholder="Statur eingeben"
                                                           required id="viewer-stature" data-editsync="stature">
                                                </div>
                                            </div>
                                            <div class="field">
                                                <label class="label">Religion:</label>
                                                <div class="control">
                                                    <input class="input editsync" type="text"
                                                           placeholder="Religion eingeben"
                                                           id="viewer-religion" data-editsync="religion">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <div class="field-body">
                                            <div class="field">
                                                <label class="label">Beruf:</label>
                                                <div class="control">
                                                    <input class="input editsync" type="text"
                                                           placeholder="Beruf eingeben"
                                                           required id="viewer-job" data-editsync="job">
                                                </div>
                                            </div>
                                            <div class="field">
                                                <label class="label">Familienstand:</label>
                                                <div class="control">
                                                    <div class="select is-fullwidth">
                                                        <select id="viewer-martialStatus" data-editsync="martialStatus"
                                                                class="editsync">
                                                            <option value="ledig">ledig</option>
                                                            <option value="verheiratet">verheiratet</option>
                                                            <option value="verwitwet">verwitwet</option>
                                                            <option value="geschieden">geschieden</option>
                                                            <option value="Ehe aufgehoben">Ehe aufgehoben</option>
                                                            <option value="in eingetragener Lebenspartnerschaft">in
                                                                eingetragener Lebenspartnerschaft
                                                            </option>
                                                            <option value="durch Tod aufgelöste Lebenspartnerschaft">
                                                                durch Tod aufgelöste Lebenspartnerschaft
                                                            </option>
                                                            <option value="aufgehobene Lebenspartnerschaft">aufgehobene
                                                                Lebenspartnerschaft
                                                            </option>
                                                            <option value="durch Todeserklärung aufgelöste Lebenspartnerschaft">
                                                                durch Todeserklärung aufgelöste
                                                                Lebenspartnerschaft
                                                            </option>
                                                            <option value="nicht bekannt">nicht bekannt</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <hr>
                                    <div class="field">
                                        <div class="field-body">
                                            <div class="field is-expanded">
                                                <h3 class="title is-3" style="font-size: 20px; margin-bottom: 10px">
                                                    Fertigkeiten:</h3>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <div class="field-body">
                                            <div class="field" style="max-width: 280px">
                                                <label class="label">Handeln: <i id="viewer-actSkills-bonus">0</i> (<i
                                                        id="viewer-actSkills-brainstorm">0</i>)</label>
                                                <div class="control">
                                                    <div class="field" id="viewer-skils-act">
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text" readonly
                                                                               id="viewer-actSkills-0-name"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-actSkills-0-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-actSkills-0-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-actSkills-1-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="viewer-actSkills-1-value" value="0"
                                                                               readonly
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-actSkills-1-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-actSkills-2-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="viewer-actSkills-2-value" value="0"
                                                                               readonly
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-actSkills-2-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-actSkills-3-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-actSkills-3-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-actSkills-3-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-actSkills-4-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-actSkills-4-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-actSkills-4-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-actSkills-5-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-actSkills-5-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-actSkills-5-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-actSkills-6-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-actSkills-6-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-actSkills-6-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-actSkills-7-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-actSkills-7-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-actSkills-7-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-actSkills-8-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-actSkills-8-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-actSkills-8-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-actSkills-9-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-actSkills-9-value" value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-actSkills-9-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="field" style="max-width: 280px">
                                                <label class="label">Wissen: <i id="viewer-knowledgeSkills-bonus">0</i>
                                                    (<i
                                                            id="viewer-knowledgeSkills-brainstorm">0</i>)</label>
                                                <div class="control">
                                                    <div class="field" id="viewer-skils-knowledge">
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text" readonly
                                                                               id="viewer-knowledgeSkills-0-name"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-knowledgeSkills-0-value"
                                                                               value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-knowledgeSkills-0-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-knowledgeSkills-1-name"
                                                                               readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="viewer-knowledgeSkills-1-value"
                                                                               value="0"
                                                                               readonly
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-knowledgeSkills-1-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-knowledgeSkills-2-name"
                                                                               readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="viewer-knowledgeSkills-2-value"
                                                                               value="0"
                                                                               readonly
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-knowledgeSkills-2-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-knowledgeSkills-3-name"
                                                                               readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-knowledgeSkills-3-value"
                                                                               value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-knowledgeSkills-3-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-knowledgeSkills-4-name"
                                                                               readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-knowledgeSkills-4-value"
                                                                               value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-knowledgeSkills-4-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-knowledgeSkills-5-name"
                                                                               readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-knowledgeSkills-5-value"
                                                                               value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-knowledgeSkills-5-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-knowledgeSkills-6-name"
                                                                               readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-knowledgeSkills-6-value"
                                                                               value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-knowledgeSkills-6-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-knowledgeSkills-7-name"
                                                                               readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-knowledgeSkills-7-value"
                                                                               value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-knowledgeSkills-7-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-knowledgeSkills-8-name"
                                                                               readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-knowledgeSkills-8-value"
                                                                               value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-knowledgeSkills-8-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-knowledgeSkills-9-name"
                                                                               readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-knowledgeSkills-9-value"
                                                                               value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-knowledgeSkills-9-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="field" style="max-width: 280px">
                                                <label class="label">Soziales: <i id="viewer-socialSkills-bonus">0</i>
                                                    (<i
                                                            id="viewer-socialSkills-brainstorm">0</i>)</label>
                                                <div class="control">
                                                    <div class="field" id="viewer-skils-social">
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text" readonly
                                                                               id="viewer-socialSkills-0-name"
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-socialSkills-0-value"
                                                                               value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-socialSkills-0-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-socialSkills-1-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="viewer-socialSkills-1-value"
                                                                               value="0"
                                                                               readonly
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-socialSkills-1-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-socialSkills-2-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number"
                                                                               id="viewer-socialSkills-2-value"
                                                                               value="0"
                                                                               readonly
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-socialSkills-2-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-socialSkills-3-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-socialSkills-3-value"
                                                                               value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-socialSkills-3-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-socialSkills-4-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-socialSkills-4-value"
                                                                               value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-socialSkills-4-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-socialSkills-5-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-socialSkills-5-value"
                                                                               value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-socialSkills-5-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-socialSkills-6-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-socialSkills-6-value"
                                                                               value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-socialSkills-6-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-socialSkills-7-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-socialSkills-7-value"
                                                                               value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-socialSkills-7-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-socialSkills-8-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-socialSkills-8-value"
                                                                               value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-socialSkills-8-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="columns is-gapless">
                                                            <div class="column is-half">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="text"
                                                                               id="viewer-socialSkills-9-name" readonly
                                                                               placeholder="Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly
                                                                               id="viewer-socialSkills-9-value"
                                                                               value="0"
                                                                               data-last="0">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="column">
                                                                <div class="field">
                                                                    <div class="control">
                                                                        <input class="input" type="number" readonly=""
                                                                               id="viewer-socialSkills-9-calc">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <hr>
                                    <div class="field">
                                        <div class="field-body">
                                            <div class="field">
                                                <label class="label">Inventar:</label>
                                                <div class="control">
                                                    <textarea class="textarea editsync" id="viewer-inventory"
                                                              data-editsync="inventory"></textarea>
                                                </div>
                                            </div>
                                            <div class="field">
                                                <label class="label">Anmerkungen:</label>
                                                <div class="control">
                                                    <textarea class="textarea editsync" id="viewer-notes"
                                                              data-editsync="notes"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <footer class="card-footer">
                                <a href="#" class="card-footer-item" onclick="exportCharacter()">Charakter
                                    exportieren</a>
                                <a href="#" class="card-footer-item" id="viewer-delete-char" onclick="deleteCharacter()"
                                   style="color: red">Charakter
                                    löschen</a>
                            </footer>
                        </div>
                    </div>
                </div>
            </div>
            <div id="page-about" class="container" style="display: none">
                <h1 class="title">Über das Tool</h1>
                Das Tool ist ein Hilfsprogramme, welches dir beim Spielen von How To Be A Hero helfen soll.
                Wir, die Entwickler, stehen in keinem direkten Zusammenhang zu der How to be a Hero e.V. How to be a
                Helper ist
                absolut frei und kann von jedem benutzt werden.
                Möchtest du beim Entwicklen mithelfen? Das Tool ist Open Source und kann auf <a
                    href="https://github.com/DasDarki/HowToBeAHelper"
                    class="external">Github</a>
                eingesehen werden.
                Das Tool steht unter der Creative Commons Namensnennung-Nicht kommerziell-Share Alike 4.0 International
                Lizenz. Diese findest du <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode.de"
                                            class="external">hier</a>
                <br>
                <br>
                <h1 class="title" id="about-version" style="font-size: 30px">Aktuelle Version: </h1>
                <i id="about-summary"></i>
                <p id="about-author" style="text-align: right"></p>
                <h3 class="title is-3" style="font-size: 20px; margin-top: 10px; margin-bottom: 0">Changelog</h3>
                <p id="about-changes"></p>
            </div>
            <div id="page-settings" style="display: none">
                <div class="columns is-centered">
                    <div class="column">
                        <div class="card events-card">
                            <header class="card-header">
                                <p class="card-header-title">
                                    Allgemeine Einstellungen
                                </p>
                            </header>
                            <div class="card-table">
                                <div class="card-content">
                                    <div class="field">
                                        <div class="field-body">
                                            <div class="field">
                                                <input id="settings-autostart" type="checkbox"
                                                       class="switch">
                                                <label for="settings-autostart">Mit Windows starten (Auto
                                                    Start)</label>
                                            </div>
                                            <div class="field">
                                                <input id="settings-startmini" type="checkbox"
                                                       class="switch">
                                                <label for="settings-startmini">Minimiert Starten</label>
                                            </div>
                                            <div class="field">
                                                <input id="settings-minitray" type="checkbox"
                                                       class="switch">
                                                <label for="settings-minitray">Zum Tray minimieren</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <footer class="card-footer">
                                <a href="#" class="card-footer-item" id="settings-logout"
                                   style="color: red">Ausloggen</a>
                            </footer>
                        </div>
                    </div>
                </div>
            </div>
            <div id="page-session" style="display: none">
                <div class="column">
                    <div class="card events-card">
                        <header class="card-header">
                            <p class="card-header-title" id="session-title">

                            </p>
                            <button class="button is-success is-small" id="session-invite">Einladen</button>
                        </header>
                        <div class="card-table">
                            <div class="content">
                                <br>
                                <table class="table is-fullwidth is-striped">
                                    <tbody id="session-players">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <footer class="card-footer">
                            <a href="#" class="card-footer-item" id="session-close" style="color: red">Session
                                schließen</a>
                        </footer>
                    </div>
                </div>
                <div class="column">
                    <div class="card events-card">
                        <header class="card-header">
                            <p class="card-header-title" id="session-ini-title">
                                Kampf
                            </p>
                            <button class="button is-success is-small" id="session-next-battler"
                                    style="margin-right: 10px">Nächster
                            </button>
                            <button class="button is-success is-small" id="session-add-battler">Hinzufügen</button>
                        </header>
                        <div class="card-table">
                            <div class="content">
                                <br>
                                <table class="table is-fullwidth is-striped">
                                    <tbody id="session-battlers">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <footer class="card-footer">
                            <a href="#" class="card-footer-item" id="session-clear-battle" style="color: red">Zurücksetzen</a>
                        </footer>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal" id="add-battler-modal">
    <div class="modal-background"></div>
    <div class="modal-card">
        <header class="modal-card-head">
            <p class="modal-card-title">Eintrag hinzufügen</p>
            <button class="delete" aria-label="close"
                    onclick="$('#add-battler-modal').removeClass('is-active')"></button>
        </header>
        <section class="modal-card-body">
            <div class="tabs is-centered is-boxed" data-tab="add-battler" data-reset-tab="add-battler-npc">
                <ul>
                    <li class="is-active tab" data-tab="add-battler-npc">
                        <a>
                            <span>NPC</span>
                        </a>
                    </li>
                    <li class="tab" data-tab="add-battler-player">
                        <a>
                            <span>Spieler</span>
                        </a>
                    </li>
                </ul>
            </div>
            <div id="add-battler-npc">
                <div class="columns is-fullwidth">
                    <div class="column">
                        <div class="field">
                            <div class="control">
                                <input type="text" class="input" placeholder="Name"
                                       id="add-battler-npc-name">
                            </div>
                        </div>
                    </div>
                    <div class="column is-one-quarter">
                        <div class="field">
                            <div class="control">
                                <input type="number" class="input" placeholder="Handlenwert"
                                       id="add-battler-npc-act">
                            </div>
                        </div>
                    </div>
                    <div class="column is-one-quarter">
                        <div class="control">
                            <button class="button is-success" id="add-battler-npc-btn">Hinzufügen</button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="add-battler-player" style="display: none">
                <div class="columns is-fullwidth">
                    <div class="column">
                        <div class="field">
                            <div class="control">
                                <div class="select is-fullwidth">
                                    <select id="add-battler-players">

                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="column is-one-quarter">
                        <div class="field">
                            <div class="control">
                                <input type="number" class="input" placeholder="Würfelwert"
                                       id="add-battler-player-dice">
                            </div>
                        </div>
                    </div>
                    <div class="column is-one-quarter">
                        <div class="control">
                            <button class="button is-success" id="add-battler-player-btn">Hinzufügen</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>
<div class="modal" id="level-modal">
    <div class="modal-background"></div>
    <div class="modal-card">
        <header class="modal-card-head">
            <p class="modal-card-title">Fertigkeiten leveln (<b id="level-xp"></b> EXP)</p>
            <button class="delete" aria-label="close" onclick="$('#level-modal').removeClass('is-active')"></button>
        </header>
        <section class="modal-card-body">
            <div id="level-simple">
                <div class="tabs is-centered is-boxed" data-tab="level-simple" data-reset-tab="level-simple-up">
                    <ul>
                        <li class="is-active tab" data-tab="level-simple-up">
                            <a>
                                <span>Talent erhöhen</span>
                            </a>
                        </li>
                        <li class="tab" data-tab="level-simple-reskill">
                            <a>
                                <span>Umskillen</span>
                            </a>
                        </li>
                        <li class="tab" data-tab="level-simple-add">
                            <a>
                                <span>Talent hinzufügen</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div id="level-simple-up">
                    <div class="columns is-fullwidth">
                        <div class="column">
                            <div class="field">
                                <div class="control">
                                    <div class="select is-fullwidth">
                                        <select id="level-simple-up-talents">

                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="column is-one-quarter">
                            <div class="control">
                                <button class="button is-success" id="level-simple-up-talent">Erhöhen (1)</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="level-simple-reskill" style="display: none">
                    <div class="columns is-fullwidth">
                        <div class="column">
                            <div class="field">
                                <div class="control">
                                    <div class="select is-fullwidth">
                                        <select id="level-simple-reskill-src">

                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="column">
                            <div class="field">
                                <div class="control">
                                    <div class="select is-fullwidth">
                                        <select id="level-simple-reskill-dest">

                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="column is-one-quarter">
                            <div class="control">
                                <button class="button is-success" id="level-simple-reskill-talent">Umskillen (1)
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="level-simple-add" style="display: none">
                    <div class="columns is-fullwidth">
                        <div class="column">
                            <div class="field">
                                <div class="control">
                                    <div class="select is-fullwidth">
                                        <select id="level-simple-add-slots">

                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="column">
                            <div class="field">
                                <div class="control">
                                    <input type="text" class="input" placeholder="Fertigkeitenname"
                                           id="level-simple-add-name">
                                </div>
                            </div>
                        </div>
                        <div class="column is-one-quarter">
                            <div class="control">
                                <button class="button is-success" id="level-simple-add-talent">Hinzufügen (1)</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="level-complex" style="display: none">
                <div class="tabs is-centered is-boxed" data-tab="level-complex" data-reset-tab="level-complex-up">
                    <ul>
                        <li class="is-active tab" data-tab="level-complex-up">
                            <a>
                                <span>Talent erhöhen</span>
                            </a>
                        </li>
                        <li class="tab" data-tab="level-complex-reskill">
                            <a>
                                <span>Umskillen</span>
                            </a>
                        </li>
                        <li class="tab" data-tab="level-complex-add">
                            <a>
                                <span>Talent hinzufügen</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div id="level-complex-up">
                    <div class="columns is-fullwidth">
                        <div class="column">
                            <div class="field">
                                <div class="control">
                                    <div class="select is-fullwidth">
                                        <select id="level-complex-up-talents">

                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="column is-one-quarter">
                            <div class="control">
                                <button class="button is-success" id="level-complex-up-talent">Erhöhen (?)</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="level-complex-reskill" style="display: none">
                    <div class="columns is-fullwidth">
                        <div class="column">
                            <div class="field">
                                <div class="control">
                                    <div class="select is-fullwidth">
                                        <select id="level-complex-reskill-src">

                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="column">
                            <div class="field">
                                <div class="control">
                                    <div class="select is-fullwidth">
                                        <select id="level-complex-reskill-dest">

                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="column is-one-quarter">
                            <div class="control">
                                <button class="button is-success" id="level-complex-reskill-talent">Umskillen (?)
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="level-complex-add" style="display: none">
                    <div class="columns is-fullwidth">
                        <div class="column">
                            <div class="field">
                                <div class="control">
                                    <div class="select is-fullwidth">
                                        <select id="level-complex-add-slots">

                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="column">
                            <div class="field">
                                <div class="control">
                                    <input type="text" class="input" placeholder="Fertigkeitenname"
                                           id="level-complex-add-name">
                                </div>
                            </div>
                        </div>
                        <div class="column is-one-quarter">
                            <div class="control">
                                <button class="button is-success" id="level-complex-add-talent">Hinzufügen (3)</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <footer class="modal-card-foot">
            <div class="select is-fullwidth">
                <select id="level-type">
                    <option value="simple">Simples Levelsystem</option>
                    <option value="complex">Komplexes Levelsystem</option>
                </select>
            </div>
        </footer>
    </div>
</div>
<div class="modal" id="join-session-modal">
    <div class="modal-background"></div>
    <div class="modal-card">
        <header class="modal-card-head">
            <p class="modal-card-title">Wähle deinen Charakter!</p>
            <button class="delete" aria-label="close"
                    onclick="$('#join-session-modal').removeClass('is-active')"></button>
        </header>
        <section class="modal-card-body">
            <div class="columns is-fullwidth">
                <div class="column">
                    <div class="field">
                        <div class="control">
                            <div class="select is-fullwidth">
                                <select id="join-session-characters">

                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="field">
                        <div class="control">
                            <button class="button is-success" id="join-session">Session beitreten</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>
<div id="loader" style="display: none">
    <div id="ld-holder">
        <div class="lds-ellipsis">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
<script>
    let currentBattle = null;

    $('#session-add-battler').click(() => {
        tabResets["add-battler"]();
        $('#add-battler-npc-act').val("");
        $('#add-battler-npc-name').val("");
        $('#add-battler-player-dice').val("");
        $('#add-battler-modal').addClass('is-active');
        $('#add-battler-players').html("");
        for (let i = 0; i < currentSession.sessionObj.players.length; i++) {
            let player = currentSession.sessionObj.players[i];
            if (!player.isPlayer) continue;
            let data = player.character.name + " (" + player.userName + ")";
            $('#add-battler-players').append(`<option value="${i}">${data}</option>`)
        }
    });

    $('#add-battler-player-btn').click(() => {
        let player = currentSession.sessionObj.players[parseInt($('#add-battler-players').val())];
        let bonus = getBonusOfSkills(player.character, "actSkills");
        let entry = {
            name: player.character.name + " (" + player.userName + ")",
            act: bonus,
            ini: parseIntSafely($('#add-battler-player-dice').val()) + bonus
        };
        currentBattle.entries.push(entry);
        sortBattleEntries();
        saveSessionBattle();
        updateSessionBattle();
        $('#add-battler-modal').removeClass('is-active');
    });

    $('#add-battler-npc-btn').click(() => {
        let act = parseIntSafely($('#add-battler-npc-act').val());
        let entry = {
            name: $('#add-battler-npc-name').val(),
            act: act,
            ini: act + getRandomInt(1, 11)
        };
        currentBattle.entries.push(entry);
        sortBattleEntries();
        saveSessionBattle();
        updateSessionBattle();
        $('#add-battler-modal').removeClass('is-active');
    });

    $('#session-next-battler').click(() => {
        currentBattle.index++;
        if (currentBattle.index >= currentBattle.entries.length) {
            currentBattle.index = 0;
        }
        saveSessionBattle();
        updateSessionBattle();
    });

    $('#session-clear-battle').click(() => {
        currentBattle.entries = [];
        saveSessionBattle();
        updateSessionBattle();
    });

    function removeBattleEntry(idx) {
        let name = currentBattle.entries[idx].name;
        Swal.fire({
            title: 'Wirklich?!',
            text: "Bist du dir sicher, dass du " + name + " aus dem Kampf entfernen willst?",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#62d630',
            cancelButtonText: 'Huch, NEIN!',
            confirmButtonText: 'Ja, will ich!'
        }).then(result => {
            if (result.isConfirmed) {
                currentBattle.entries.splice(idx, 1);
                if (currentBattle.entries.length <= currentBattle.index) {
                    currentBattle.index = 0;
                }
                saveSessionBattle();
                updateSessionBattle();
            }
        });
    }

    function updateSessionBattle() {
        $('#session-battlers').html("");
        for (let i = 0; i < currentBattle.entries.length; i++) {
            let entry = currentBattle.entries[i];
            let clazz = currentBattle.index == i ? "on-row" : "";
            $('#session-battlers').append(`<tr class="${clazz}">
                    <td width="5%"><i class="fas fa-khanda"></i></td>
                    <td>${entry.name}</td>
                    <td class="level-right">
                        <label style="margin-right: 10px">
                        <button class="button is-small is-danger" onclick="removeBattleEntry(${i})">Löschen</button>
                    </td>
                </tr>`);
        }
    }

    function getRandomInt(min, max) {
        min = Math.ceil(min);
        max = Math.floor(max);
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function saveSessionBattle() {
        bridge.saveSessionBattle(currentSession.sessionObj.uuid, JSON.stringify(currentBattle));
    }

    function sortBattleEntries() {
        let newEntries = [];
        while (currentBattle.entries.length > 0) {
            let currentEntries = getHighestEntries();
            currentEntries = shuffle(currentEntries);
            for (let i = 0; i < currentEntries.length; i++) {
                newEntries.push(currentEntries[i]);
            }
        }
        currentBattle.entries = newEntries;
    }

    function shuffle(a) {
        for (let i = a.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [a[i], a[j]] = [a[j], a[i]];
        }
        return a;
    }

    function getHighestEntries() {
        let highest = [];
        let removals = [];
        let value = getHighestValue();
        for (let i = 0; i < currentBattle.entries.length; i++) {
            if (currentBattle.entries[i].ini == value) {
                highest.push(currentBattle.entries[i]);
                removals.push(i);
            }
        }
        for (let i = 0; i < removals.length; i++) {
            currentBattle.entries.splice(removals[i], 1);
        }
        return highest;
    }

    function getHighestValue() {
        let current = 0;
        for (let i = 0; i < currentBattle.entries.length; i++) {
            let entry = currentBattle.entries[i];
            if (entry.ini > current)
                current = entry.ini;
        }
        return current;
    }
</script>
<script>
    let currentSession = null;
    let joiningSessionId = null;
    let joiningSessionPassword = null;
    let joiningSessionCallback = null;

    $('#session-invite').click(() => {
        if (!currentSession) return;
        Swal.fire({
            title: 'Hier, zum Einladen:',
            icon: 'info',
            html: `Entweder ganz automatisch: <br><b>htbah://session/?id=${currentSession.session}&pw=${currentSession.sessionObj.password}</b><br>oder manuell:<br>ID: <b>${currentSession.session}</b><br>Passwort: <b>${currentSession.sessionObj.password}</b>`,
            showCloseButton: true
        });
    });

    $('#join-session').click(() => {
        let charIdx = $('#join-session-characters').val();
        if (charIdx == -1) {
            Swal.fire({
                icon: 'error',
                title: 'Warte!',
                text: 'Du musst einen Charakter auswählen!',
            });
            return;
        }
        $('#loader').show();
        bridge.joinSession(joiningSessionId, joiningSessionPassword, characters[charIdx].uuid, (newSession) => {
            joiningSessionCallback(newSession);
            joiningSessionCallback = null;
            joiningSessionPassword = null;
            joiningSessionId = null;
            $('#session-join-id').val("");
            $('#session-join-password').val("");
            $('#join-session-modal').removeClass('is-active');
            $('#loader').hide();
        });
    });

    function createSession() {
        $('#session-create-name').removeClass('is-danger');
        let name = $('#session-create-name').val();
        if (!name || name.trim().length <= 0) {
            $('#session-create-name').addClass('is-danger');
            return;
        }
        let password = $('#session-create-password').val() || "";
        $('#loader').show();
        bridge.createSession(name, password, newSession => {
            if (newSession.trim().length > 0) {
                $('#session-create-name').val("");
                $('#session-create-password').val("");
                let sessionData = JSON.parse(newSession.split('\\"').join('"'));
                let session = sessionData[0];
                session.sessionObj = sessionData[1];
                sessions.push(session);
                appendSession(session, sessions.length - 1);
                Swal.fire({
                    icon: 'success',
                    title: 'Viel Spaß!',
                    text: 'Deine Sesssion wurde angelegt!',
                });
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Nop!',
                    text: 'Leider konnten wir keine Session für dich anlegen!',
                });
            }
            $('#loader').hide();
        });
    }

    function joinSession() {
        $('#session-join-id').removeClass('is-danger');
        let sessionId = $('#session-join-id').val();
        if (!sessionId || sessionId.trim().length <= 0) {
            $('#session-join-id').addClass('is-danger');
            return;
        }
        let sessionPassword = $('#session-join-password').val();
        joinSpecificSession(sessionId, sessionPassword);
    }

    function joinSpecificSession(sessionId, sessionPassword) {
        joiningSessionId = sessionId;
        joiningSessionPassword = sessionPassword;
        joiningSessionCallback = (newSession) => {
            if (!newSession || newSession.trim().length <= 0) {
                Swal.fire({
                    icon: 'error',
                    title: 'Die magische Barriere ist zu stark!',
                    text: 'Leider konntest du der Session nicht beitreten!',
                });
            } else {
                let session = JSON.parse(newSession.split('\\"').join('"'));
                sessions.push(session);
                appendSession(session, sessions.length - 1);
                Swal.fire({
                    icon: 'success',
                    title: 'Eingetreten!',
                    text: 'Du bist nun in der Welt von "' + session.sessionName + '"',
                });
            }
        };
        $('#join-session-characters').html("");
        $('#join-session-characters').append(`<option value="-1">(Charakter auswählen)</option>`);
        for (let i = 0; i < characters.length; i++) {
            $('#join-session-characters').append(`<option value="${i}">${characters[i].name}</option>`)
        }
        $('#join-session-modal').addClass('is-active');
    }

    function onMuteFlagChange(name, checkbox) {
        bridge.sendMuteToggle(name, checkbox.value);
    }

    function appendSessionPlayer(sessionIdx, i) {
        if (!currentSession) return;
        let player = currentSession.sessionObj.players[i];
        if (!player.isPlayer) return;
        /*
        <input type="checkbox" class="checkbox" onchange="onMuteFlagChange('${player.userName}', this)">
                        Mute TeamSpeak
                        </label>
         */
        $('#session-players').append(`<tr>
                    <td width="5%"><i class="fas fa-users-cog"></i></td>
                    <td>${player.userName}</td>
                    <td class="level-right">
                        <label style="margin-right: 10px">

                        <a class="button is-small is-success" href="#" onclick="selectSessionPlayer(${i})">Ansehen</a>
                        <button class="button is-small is-danger" onclick="kickPlayer(${sessionIdx}, ${i})">Kicken</button>
                    </td>
                </tr>`);
    }

    $('#session-close').click(() => {
        if (!currentSession) return;
        Swal.fire({
            title: 'Wirklich?!',
            text: "Bist du dir sicher, dass du die Session " + currentSession.name + " löschen willst?",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#62d630',
            cancelButtonText: 'Huch, NEIN!',
            confirmButtonText: 'Ja, will ich!'
        }).then(result => {
            if (result.isConfirmed) {
                $('#loader').show();
                bridge.closeSession(currentSession.session, success => {
                    if (success) {
                        applySessionKick(currentSession.session);
                        $('#loader').hide();
                        Swal.fire({
                            icon: 'success',
                            title: 'Es ist weg...',
                            text: `Die Session wurde gelöscht!`,
                        });
                    } else {
                        $('#loader').hide();
                        Swal.fire({
                            icon: 'error',
                            title: 'Huch?',
                            text: `Leider konnten wir sie nicht entfernen!`,
                        });
                    }
                });
            }
        });
    });

    function kickPlayer(sessionIdx, i) {
        if (!currentSession) return;
        let player = currentSession.sessionObj.players[i];
        Swal.fire({
            title: 'Wirklich?!',
            text: "Bist du dir sicher, dass du " + player.userName + " herauswerfen willst?",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#62d630',
            cancelButtonText: 'Huch, NEIN!',
            confirmButtonText: 'Ja, will ich!'
        }).then(result => {
            if (result.isConfirmed) {
                $('#loader').show();
                let playerId = player.user;
                bridge.kickPlayer(currentSession.session, playerId, success => {
                    if (success) {
                        let idx = -1;
                        for (let i = 0; i < currentSession.sessionObj.players.length; i++) {
                            if (currentSession.sessionObj.players[i].user == playerId) {
                                idx = i;
                                break;
                            }
                        }
                        if (idx != -1) {
                            currentSession.sessionObj.players.splice(idx, 1);
                            selectSession(sessionIdx);
                        }
                        $('#loader').hide();
                        Swal.fire({
                            icon: 'success',
                            title: 'Er ist weg...',
                            text: `Der Spieler wurde erfolgreich entfernt!`,
                        });
                    } else {
                        $('#loader').hide();
                        Swal.fire({
                            icon: 'error',
                            title: 'Huch?',
                            text: `Leider konnten wir ihn nicht entfernen!`,
                        });
                    }
                });
            }
        });
    }

    function selectSessionPlayer(i) {
        if (!currentSession) return;
        deselectCurrentPage();
        let player = currentSession.sessionObj.players[i];
        selectCharacter(player.character, true, -1001);
    }

    function selectSession(idx) {
        deselectCurrentPage();
        let session = sessions[idx];
        currentSession = session;
        let q;
        if (session.isPlayer) {
            q = $('#page-char-viewer');
            selectCharacter(session.character, true, -1001);
        } else {
            $('#session-title').html(session.sessionName);
            $('#session-players').html("");
            for (let i = 0; i < session.sessionObj.players.length; i++) {
                appendSessionPlayer(idx, i);
            }
            bridge.getSessionBattlers(session.sessionObj.uuid, function (data) {
                currentBattle = data == null || data.length <= 0 ? {
                    index: 0,
                    entries: []
                } : JSON.parse(data);
                updateSessionBattle();
            });
            q = $('#page-session');
        }
        q.show();
        let s = $('#session-switch-' + session.session);
        s.addClass('is-active');
        currentPage = {
            content: q,
            switch: s
        };
    }

    $('#sessions-list-actions').click(() => {
        deselectCurrentPage();
        let q = $('#page-sessions-actions');
        q.show();
        currentPage = {
            content: q,
            switch: null
        };
    });
</script>
<script>
    let selectedCharacter = null;
    let selectedCharIdx = 0;
    let localSelected = false;
    let tabResets = {};
    let tabControllers = {};
    let complexLevelXp = 0;
    let complexReskillXp = 0;
    let isSessionView = false;

    function addSkill(slot, name, xp, startVal) {
        if (!name || name.trim().length <= 0) {
            Swal.fire({
                icon: 'error',
                title: 'Nö!',
                text: `Dein neues Talent brauch auch einen Namen!`,
            });
            return;
        }
        if (slot == "-1") return;
        let parts = slot.split('-');
        let type = parts[0];
        let idx = parseInt(parts[1]);
        if (isNaN(idx)) return;
        let skill = selectedCharacter[type][idx];
        if (selectedCharacter.xp >= xp) {
            selectedCharacter.xp -= xp;
            $('#viewer-xp').val(selectedCharacter.xp);
            $('#level-xp').html(selectedCharacter.xp);
            skill.name = name;
            skill.value = startVal;
            fillAllLevelSkills();
            fillCharSkillsInView(type);
            $('#level-simple-add-name').val("");
            if (isSessionView) {
                bridge.syncSessionCharData(currentSession.session, loginName, selectedCharacter.uuid, "xp", JSON.stringify(selectedCharacter.xp));
                bridge.syncSessionSkills(currentSession.session, selectedCharacter.uuid, JSON.stringify([{
                    type: type,
                    name: skill.name,
                    idx: idx,
                    val: skill.value
                }]));
            } else if (localSelected) {
                bridge.syncCharDataLocally(JSON.stringify(selectedCharacter));
            } else {
                bridge.syncCharData(loginName, selectedCharacter.uuid, "xp", JSON.stringify(selectedCharacter.xp));
                bridge.syncSkills(loginName, selectedCharacter.uuid, JSON.stringify([{
                    type: type,
                    name: skill.name,
                    idx: idx,
                    val: skill.value
                }]));
            }
            Swal.fire({
                icon: 'success',
                title: 'Skadaboosh!',
                text: `Und nun ist dein Charakter durch ${name} besser! JUHUUUUU!`,
            });
        } else {
            Swal.fire({
                icon: 'error',
                title: 'Zu wenig!',
                text: `Du hast leider nicht genug EXP (benötigt: ${xp})!`,
            });
        }
    }

    function reskillTalent(srcTalent, destTalent, xp) {
        if (srcTalent == "-1") return;
        let srcParts = srcTalent.split('-');
        let srcType = srcParts[0];
        let srcIdx = parseInt(srcParts[1]);
        if (isNaN(srcIdx)) return;
        let srcSkill = selectedCharacter[srcType][srcIdx];
        if (srcSkill.value - 10 < 0) {
            Swal.fire({
                icon: 'error',
                title: 'Es wird zu klein...',
                text: `Du kannst nicht ins Minus umskillen!`,
            });
            return;
        }
        if (destTalent == "-1") return;
        let destParts = destTalent.split('-');
        let destType = destParts[0];
        let destIdx = parseInt(destParts[1]);
        if (isNaN(destIdx)) return;
        if (destType != srcType) {
            Swal.fire({
                icon: 'error',
                title: 'You shall not pass!',
                text: `Du kannst nur in der selben Kategorie umskillen!`,
            });
            return;
        }
        if (selectedCharacter.xp >= xp) {
            selectedCharacter.xp -= xp;
            $('#viewer-xp').val(selectedCharacter.xp);
            $('#level-xp').html(selectedCharacter.xp);
            let destSkill = selectedCharacter[destType][destIdx];
            srcSkill.value -= 10;
            destSkill.value += 10;
            fillCharSkillsInView(srcType);
            calculateReskillXp($('#level-complex-reskill-src').val(), $('#level-complex-reskill-dest').val());
            if (isSessionView) {
                bridge.syncSessionCharData(currentSession.session, loginName, selectedCharacter.uuid, "xp", JSON.stringify(selectedCharacter.xp));
                bridge.syncSessionSkills(currentSession.session, selectedCharacter.uuid, JSON.stringify([{
                    type: srcType,
                    name: srcSkill.name,
                    idx: srcIdx,
                    val: srcSkill.value
                }, {
                    type: destType,
                    name: destSkill.name,
                    idx: destIdx,
                    val: destSkill.value
                }]));
            } else if (localSelected) {
                bridge.syncCharDataLocally(JSON.stringify(selectedCharacter));
            } else {
                bridge.syncCharData(loginName, selectedCharacter.uuid, "xp", JSON.stringify(selectedCharacter.xp));
                bridge.syncSkills(loginName, selectedCharacter.uuid, JSON.stringify([{
                    type: srcType,
                    name: srcSkill.name,
                    idx: srcIdx,
                    val: srcSkill.value
                }, {
                    type: destType,
                    name: destSkill.name,
                    idx: destIdx,
                    val: destSkill.value
                }]));
            }
            Swal.fire({
                icon: 'success',
                title: 'Skadaboosh!',
                text: `Und schon ist ${selectedCharacter[srcType][srcIdx].name} schwächer und ${selectedCharacter[destType][destIdx].name} stärker!`,
            });
        } else {
            Swal.fire({
                icon: 'error',
                title: 'Zu wenig!',
                text: `Du hast leider nicht genug EXP (benötigt: ${xp})!`,
            });
        }
    }

    function levelTalent(skillType, skillIdx, raiseVal, xp) {
        if (selectedCharacter.xp >= xp) {
            selectedCharacter.xp -= xp;
            $('#viewer-xp').val(selectedCharacter.xp);
            $('#level-xp').html(selectedCharacter.xp);
            let skill = selectedCharacter[skillType][skillIdx];
            skill.value += raiseVal;
            fillCharSkillsInView(skillType);
            if (isSessionView) {
                bridge.syncSessionCharData(currentSession.session, loginName, selectedCharacter.uuid, "xp", JSON.stringify(selectedCharacter.xp));
                bridge.syncSessionSkills(currentSession.session, selectedCharacter.uuid, JSON.stringify([{
                    type: skillType,
                    name: skill.name,
                    idx: skillIdx,
                    val: skill.value
                }]));
            } else if (localSelected) {
                bridge.syncCharDataLocally(JSON.stringify(selectedCharacter));
            } else {
                bridge.syncCharData(loginName, selectedCharacter.uuid, "xp", JSON.stringify(selectedCharacter.xp));
                bridge.syncSkills(loginName, selectedCharacter.uuid, JSON.stringify([{
                    type: skillType,
                    name: skill.name,
                    idx: skillIdx,
                    val: skill.value
                }]));
            }
            Swal.fire({
                icon: 'success',
                title: 'Skadaboosh!',
                text: `Und schon bist du besser in ${selectedCharacter[skillType][skillIdx].name}!`,
            });
        } else {
            Swal.fire({
                icon: 'error',
                title: 'Zu wenig!',
                text: `Du hast leider nicht genug EXP (benötigt: ${xp})!`,
            });
        }
    }

    $('#level-complex-add-talent').click(() => {
        addSkill($('#level-complex-add-slots').val(), $('#level-complex-add-name').val(), 3, 5);
    });

    $('#level-simple-add-talent').click(() => {
        addSkill($('#level-simple-add-slots').val(), $('#level-simple-add-name').val(), 1, 0);
    });

    $('#level-simple-reskill-talent').click(() => {
        reskillTalent($('#level-simple-reskill-src').val(), $('#level-simple-reskill-dest').val(), 1);
    });

    $('#level-complex-reskill-talent').click(() => {
        if (complexReskillXp <= -1) return;
        reskillTalent($('#level-complex-reskill-src').val(), $('#level-complex-reskill-dest').val(), complexReskillXp);
    });

    $('#level-complex-up-talent').click(() => {
        if (complexLevelXp <= -1) return;
        let skill = $('#level-complex-up-talents').val();
        if (skill == "-1") return;
        let parts = skill.split('-');
        let type = parts[0];
        let idx = parseInt(parts[1]);
        if (isNaN(idx)) return;
        levelTalent(type, idx, 5, complexLevelXp);
    });

    $('#level-simple-up-talent').click(() => {
        let skill = $('#level-simple-up-talents').val();
        if (skill == "-1") return;
        let parts = skill.split('-');
        let type = parts[0];
        let idx = parseInt(parts[1]);
        if (isNaN(idx)) return;
        levelTalent(type, idx, 5, 1);
    });

    $('#level-type').on('change', function () {
        $('#level-complex').hide();
        $('#level-simple').hide();
        $('#level-' + this.value).show();
    });

    $('.tabs').each(function () {
        let tabs = $(this);
        let tabsName = tabs.data("tab");
        let lastQ = null;
        let deselect = () => {
            if (lastQ != null) {
                lastQ.tab.removeClass('is-active');
                lastQ.page.hide();
                lastQ = null;
            }
        };
        let select = (name) => {
            deselect();
            let tab = tabControllers[name];
            tab.addClass('is-active');
            let page = $('#' + name);
            page.show();
            lastQ = {
                tab: tab,
                page: page
            };
        };
        tabs.children().first().children('.tab').each(function () {
            let tab = $(this);
            const tabName = tab.data("tab");
            tab.click(() => {
                select(tabName);
            });
            tabControllers[tabName] = tab;
        });
        if (tabs.data("reset-tab")) {
            const resetTab = tabs.data("reset-tab");
            tabResets[tabsName] = () => {
                select(resetTab);
            };
            tabResets[tabsName]();
        }
    });

    function resetLevelModal() {
        complexLevelXp = -1;
        complexReskillXp = -1;
        tabResets["level-simple"]();
        tabResets["level-complex"]();
        $('#level-complex-up-talent').html("Erhöhen (?)");
        $('#level-complex-reskill-talent').html("Umskillen (?)");
        $('#level-xp').html(selectedCharacter.xp);
        $('#level-simple-add-name').val("");
        fillAllLevelSkills();
    }

    function getSkillBonus(type) {
        let skills = selectedCharacter[type];
        let bonus = 0;
        for (let i = 0; i < skills.length; i++) {
            bonus += skills[i].value;
        }
        return Math.round(bonus / 10);
    }

    function calculateReskillXp(src, dest) {
        if (src == "-1" || dest == "-1") {
            complexReskillXp = -1;
            $('#level-complex-reskill-talent').html("Umskillen (?)");
            return;
        }
        let srcParts = src.split('-');
        let srcType = srcParts[0];
        let srcIdx = parseInt(srcParts[1]);
        let srcVal = selectedCharacter[srcType][srcIdx].value;
        let destParts = dest.split('-');
        let destType = destParts[0];
        let destIdx = parseInt(destParts[1]);
        let destVal = selectedCharacter[destType][destIdx].value;
        if (destType != srcType) {
            complexReskillXp = -1;
            $('#level-complex-reskill-talent').html("Umskillen (?)");
            Swal.fire({
                icon: 'error',
                title: 'You shall not pass!',
                text: `Du kannst nur in der selben Kategorie umskillen!`,
            });
            return;
        }
        complexReskillXp = Math.round((destVal - (srcVal - 5)) / ((getSkillBonus(srcType) / 10 + 1) * 5));
        if (complexReskillXp < 1)
            complexReskillXp = 1;
        $('#level-complex-reskill-talent').html("Umskillen (" + complexReskillXp + ")");
    }

    $('#level-complex-reskill-dest').on("change", function () {
        calculateReskillXp($('#level-complex-reskill-src').val(), $('#level-complex-reskill-dest').val());
    });

    $('#level-complex-reskill-src').on("change", function () {
        calculateReskillXp($('#level-complex-reskill-src').val(), $('#level-complex-reskill-dest').val());
    });

    $('#level-complex-up-talents').on("change", function () {
        let skill = this.value;
        if (skill == "-1") {
            complexLevelXp = -1;
            $('#level-complex-up-talent').html("Erhöhen (?)");
            return;
        }
        let parts = skill.split('-');
        let type = parts[0];
        let idx = parseInt(parts[1]);
        let currentVal = selectedCharacter[type][idx].value;
        let bonus = getSkillBonus(type);
        complexLevelXp = Math.round((currentVal / 5) / (bonus / 10 + 1));
        if (complexLevelXp < 1)
            complexLevelXp = 1;
        $('#level-complex-up-talent').html("Erhöhen (" + complexLevelXp + ")");
    });

    function fillAllLevelSkills() {
        $('#level-simple-up-talents').html("");
        $('#level-simple-up-talents').append(`<option value="-1">(Fertigkeit auswählen)</option>`);
        fillLevelSkills($('#level-simple-up-talents'), "actSkills", "Handlen");
        fillLevelSkills($('#level-simple-up-talents'), "knowledgeSkills", "Wissen");
        fillLevelSkills($('#level-simple-up-talents'), "socialSkills", "Soziales");
        $('#level-complex-up-talents').html("");
        $('#level-complex-up-talents').append(`<option value="-1">(Fertigkeit auswählen)</option>`);
        fillLevelSkills($('#level-complex-up-talents'), "actSkills", "Handlen");
        fillLevelSkills($('#level-complex-up-talents'), "knowledgeSkills", "Wissen");
        fillLevelSkills($('#level-complex-up-talents'), "socialSkills", "Soziales");
        $('#level-simple-reskill-src').html("");
        $('#level-simple-reskill-src').append(`<option value="-1">(Quell-Fertigkeit auswählen)</option>`);
        fillLevelSkills($('#level-simple-reskill-src'), "actSkills", "Handlen");
        fillLevelSkills($('#level-simple-reskill-src'), "knowledgeSkills", "Wissen");
        fillLevelSkills($('#level-simple-reskill-src'), "socialSkills", "Soziales");
        $('#level-simple-reskill-dest').html("");
        $('#level-simple-reskill-dest').append(`<option value="-1">(Ziel-Fertigkeit auswählen)</option>`);
        fillLevelSkills($('#level-simple-reskill-dest'), "actSkills", "Handlen");
        fillLevelSkills($('#level-simple-reskill-dest'), "knowledgeSkills", "Wissen");
        fillLevelSkills($('#level-simple-reskill-dest'), "socialSkills", "Soziales");
        $('#level-complex-reskill-src').html("");
        $('#level-complex-reskill-src').append(`<option value="-1">(Quell-Fertigkeit auswählen)</option>`);
        fillLevelSkills($('#level-complex-reskill-src'), "actSkills", "Handeln");
        fillLevelSkills($('#level-complex-reskill-src'), "knowledgeSkills", "Wissen");
        fillLevelSkills($('#level-complex-reskill-src'), "socialSkills", "Soziales");
        $('#level-complex-reskill-dest').html("");
        $('#level-complex-reskill-dest').append(`<option value="-1">(Ziel-Fertigkeit auswählen)</option>`);
        fillLevelSkills($('#level-complex-reskill-dest'), "actSkills", "Handeln");
        fillLevelSkills($('#level-complex-reskill-dest'), "knowledgeSkills", "Wissen");
        fillLevelSkills($('#level-complex-reskill-dest'), "socialSkills", "Soziales");
        $('#level-simple-add-slots').html("");
        $('#level-simple-add-slots').append(`<option value="-1">(Fertigkeitenslot auswählen)</option>`);
        fillFreeSkills($('#level-simple-add-slots'), "actSkills", "Handeln");
        fillFreeSkills($('#level-simple-add-slots'), "knowledgeSkills", "Wissen");
        fillFreeSkills($('#level-simple-add-slots'), "socialSkills", "Soziales");
        $('#level-complex-add-slots').html("");
        $('#level-complex-add-slots').append(`<option value="-1">(Fertigkeitenslot auswählen)</option>`);
        fillFreeSkills($('#level-complex-add-slots'), "actSkills", "Handeln");
        fillFreeSkills($('#level-complex-add-slots'), "knowledgeSkills", "Wissen");
        fillFreeSkills($('#level-complex-add-slots'), "socialSkills", "Soziales");
    }

    function fillFreeSkills(q, type, title) {
        q.append(`<option value="-1">--- <b>${title}</b> ---</option>`);
        let skills = selectedCharacter[type];
        for (let i = 0; i < skills.length; i++) {
            let name = skills[i].name;
            if (!name || name.trim().length <= 0) {
                q.append(`<option value="${type}-${i}">FREIER SLOT [${i + 1}]</option>`);
            }
        }
    }

    function fillLevelSkills(q, type, title) {
        q.append(`<option value="-1">--- <b>${title}</b> ---</option>`);
        let skills = selectedCharacter[type];
        for (let i = 0; i < skills.length; i++) {
            let name = skills[i].name;
            if (!name || name.trim().length <= 0) continue;
            q.append(`<option value="${type}-${i}">${name}</option>`);
        }
    }

    function levelCharacter() {
        resetLevelModal();
        $('#level-modal').addClass('is-active');
    }

    function deleteCharacter() {
        if (isSessionView) return;
        Swal.fire({
            title: 'Wirklich?!',
            text: "Bist du dir absolut sicher, dass du diesen Charakter löschen willst? Es kann nicht wieder rückgängig gemacht werden!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#62d630',
            cancelButtonText: 'NEIN! Nicht löschen!',
            confirmButtonText: 'Ja, ist ok!'
        }).then((result) => {
            if (result.isConfirmed) {
                const fromYear = selectedCharacter.createdAt;
                const toYear = new Date().getFullYear();
                bridge.deleteCharacter(loginName, localSelected, selectedCharacter.uuid, success => {
                    if (success) {
                        if (localSelected) {
                            localCharacters.splice(selectedCharIdx, 1);
                            updateLocalCharacters();
                        } else {
                            characters.splice(selectedCharIdx, 1);
                            updateRemoteCharacters();
                        }
                        selectPage("dashboard");
                        Swal.fire({
                            icon: 'success',
                            title: 'Und weg ist er...',
                            text: `Ruhe er in Frieden (${fromYear} - ${toYear})!`,
                        });
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: 'Mhhmmm!',
                            text: 'Nö, unsere Macht war nicht groß genug! Wir konnten ihn nicht töten, Meister.',
                        });
                    }
                });
            }
        });
    }

    function exportCharacter() {
        bridge.exportCharacter(JSON.stringify(selectedCharacter), success => {
            if (success) {
                Swal.fire({
                    icon: 'success',
                    title: 'Geschafft!',
                    text: 'Dein Charakter wurde erfolgreich exportiert und dort gespeichert wo du wolltest!',
                });
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Fehler!',
                    text: 'Irgendwie ist ein Fehler aufgetreten! :(',
                });
            }
        });
    }

    function selectCharacter(character, isLocal, idx) {
        isSessionView = idx == -1001;
        if (isSessionView) {
            $('#viewer-delete-char').hide();
        } else {
            $('#viewer-delete-char').show();
        }
        selectedCharacter = character;
        localSelected = isLocal;
        selectedCharIdx = idx;
        $('#viewer-xp').val(character.xp);
        $('#viewer-health').val(character.health);
        $('#viewer-name').val(character.name);
        $('#viewer-age').val(character.age);
        $('#viewer-gender').val(character.gender);
        $('#viewer-religion').val(character.religion);
        $('#viewer-job').val(character.job);
        $('#viewer-stature').val(character.stature);
        $('#viewer-martialStatus').val(character.martialStatus);
        $('#viewer-notes').val(character.notes);
        $('#viewer-inventory').val(character.inventory);
        fillCharSkillsInView("actSkills");
        fillCharSkillsInView("socialSkills");
        fillCharSkillsInView("knowledgeSkills");
        let q = $('#page-char-viewer');
        q.show();
        currentPage = {
            content: q,
            switch: null
        };
    }

    function getBonusOfSkills(character, type) {
        let skills = character[type];
        let bonus = 0;
        for (let i = 0; i < 10; i++) {
            bonus += skills[i].value;
        }
        return Math.round(bonus / 10);
    }

    function fillCharSkillsInView(type) {
        if (!selectedCharacter) return;
        let skills = selectedCharacter[type];
        let bonus = 0;
        for (let i = 0; i < 10; i++) {
            bonus += skills[i].value;
        }
        bonus = Math.round(bonus / 10);
        for (let i = 0; i < 10; i++) {
            let skill = skills[i];
            $(`#viewer-${type}-${i}-name`).val(skill.name);
            $(`#viewer-${type}-${i}-value`).val(skill.value);
            $(`#viewer-${type}-${i}-calc`).val(skill.value + bonus);
        }
        let flash = Math.round(bonus / 10);
        $('#viewer-' + type + '-bonus').html(bonus.toString());
        $('#viewer-' + type + '-brainstorm').html(flash.toString());
    }

    $('.editsync').each(function () {
        let q = $(this);
        let key = q.data("editsync");
        if (key) {
            let required = q.prop("required");
            let cooldown = null;
            let type = q.attr("type");
            let isNumber = type && type == "number";
            let sync = () => {
                q.removeClass('is-danger');
                let val = q.val();
                if (required && (!val || val.trim().length <= 0)) {
                    q.addClass('is-danger');
                    return;
                }
                if (isNumber) {
                    val = parseIntSafely(val);
                    if (key == "age") {
                        if (val > 1000000000) {
                            Swal.fire({
                                icon: 'error',
                                title: 'Öhm, zu viel?!',
                                text: 'Du kannst nicht älter als 1 Mrd. Jahre alt sein!',
                            });
                            return;
                        }
                    }
                }
                selectedCharacter[key] = val;
                if (isSessionView) {
                    bridge.syncSessionCharData(currentSession.session, loginName, selectedCharacter.uuid, key, JSON.stringify(val));
                } else if (localSelected) {
                    bridge.syncCharDataLocally(JSON.stringify(selectedCharacter));
                    updateLocalCharacters();
                } else {
                    bridge.syncCharData(loginName, selectedCharacter.uuid, key, JSON.stringify(val));
                    updateRemoteCharacters();
                }
            };
            q.on('keyup mouseup change paste input', () => {
                if (cooldown != null) {
                    clearTimeout(cooldown);
                    cooldown = null;
                }
                cooldown = setTimeout(sync, 3000);
            });
            this.addEventListener('focusout', function () {
                if (cooldown != null) {
                    clearTimeout(cooldown);
                    cooldown = null;
                }
                sync();
            });
        }
    });
</script>
<script>
    let currentCharacter;
    let editorSkillControls;
    let editorSkillBonuses;

    function findCharacterById(id) {
        for (let i = 0; i < characters.length; i++)
            if (characters[i].uuid === id)
                return characters[i];
        return null;
    }

    function findCharacterIdxById(id) {
        for (let i = 0; i < characters.length; i++)
            if (characters[i].uuid === id)
                return i;
        return -1;
    }

    function generateCharId() {
        let uuid = uuidv4();
        while (findCharacterById(uuid)) {
            uuid = uuidv4();
        }
        return uuid;
    }

    function parseIntSafely(val) {
        let i = parseInt(val);
        if (!i || isNaN(i))
            i = 0;
        return i;
    }

    function resetCharEditor() {
        Swal.fire({
            icon: 'warning',
            title: 'Sicher?',
            text: 'Bist du dir sicher, dass du dies tun möchtest?',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#62d630',
            cancelButtonText: 'Nein, warn versehen!',
            confirmButtonText: 'JA!'
        }).then(result => {
            if (result) {
                resetCharacterEditor();
            }
        });
    }

    function finishCharacter() {
        $('#editor-name').removeClass('is-danger');
        let name = $('#editor-name').val().trim();
        if (name.length <= 0) {
            $('#editor-name').addClass('is-danger');
            Swal.fire({
                icon: 'error',
                title: 'Da fehlt was!',
                text: 'Dein Charakter brauch einen Namen!',
            });
            return;
        }
        $('#editor-job').removeClass('is-danger');
        let job = $('#editor-job').val().trim();
        if (job.length <= 0) {
            $('#editor-job').addClass('is-danger');
            Swal.fire({
                icon: 'error',
                title: 'Du bist Arbeitslos!',
                text: 'Bitte trage einen Beruf ein! Und ja, Arbeitsloser ist auch ein valider Beruf!',
            });
            return;
        }
        $('#editor-stature').removeClass('is-danger');
        let stature = $('#editor-stature').val().trim();
        if (stature.length <= 0) {
            $('#editor-stature').addClass('is-danger');
            Swal.fire({
                icon: 'error',
                title: 'Wie siehst du aus?',
                text: 'Dein Charakter benötigt eine Statur, und sei es nur "Lauch"!',
            });
            return;
        }
        let callback = () => {
            currentCharacter.uuid = generateCharId();
            currentCharacter.age = parseIntSafely($('#editor-age').val());
            if (currentCharacter.age > 1000000000) {
                Swal.fire({
                    icon: 'error',
                    title: 'Öhm, zu viel?!',
                    text: 'Du kannst nicht älter als 1 Mrd. Jahre alt sein!',
                });
                return;
            }
            currentCharacter.name = name;
            currentCharacter.gender = $('#editor-gender').val();
            if (currentCharacter.gender == "def") {
                Swal.fire({
                    icon: 'error',
                    title: 'Was bist du?',
                    text: 'Du musst noch dein Geschlecht wählen? Wenn du kein Plan hast oder dich als Helikopter identifizierst, nehme doch einfach "divers"!',
                });
                return;
            }
            currentCharacter.martialStatus = $('#editor-martialstatus').val();
            currentCharacter.inventory = $('#editor-inventory').val();
            currentCharacter.notes = $('#editor-notes').val();
            currentCharacter.religion = $('#editor-religion').val();
            currentCharacter.stature = stature;
            currentCharacter.job = job;
            currentCharacter.pointsLeft = freePoints;
            normalizeSkillGroup("actSkills");
            normalizeSkillGroup("knowledgeSkills");
            normalizeSkillGroup("socialSkills");
            bridge.saveCharacter(JSON.stringify(currentCharacter), loginName, (success, isLocal) => {
                if (success) {
                    if (isLocal) {
                        localCharacters.push(currentCharacter);
                        updateLocalCharacters();
                    } else {
                        characters.push(currentCharacter);
                        updateRemoteCharacters();
                    }
                    resetCharacterEditor();
                    Swal.fire({
                        icon: 'success',
                        title: 'Yeah!',
                        text: 'Dein Charakter ist jetzt sicher!',
                    });
                } else {
                    Swal.fire({
                        icon: 'error',
                        title: 'Upsi!',
                        text: 'Leider konnten wir deinen Charakter nicht abspeichern! Wir haben ihn solange lokal gespeichert!',
                    });
                }
            });
        };
        let freePoints = calculateFreePoints();
        if (freePoints > 0) {
            Swal.fire({
                icon: 'error',
                title: 'Huch!',
                text: 'Du hast noch Punkte übrig! Die müssen noch weg :) Wichtig: Du kannst die Punkte nach der Beendigung des Charakters nicht mehr verwenden!',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#62d630',
                cancelButtonText: 'Ok, ich geb sie noch aus!',
                confirmButtonText: 'Egal...'
            }).then(result => {
                if (result) {
                    callback();
                }
            });
            return;
        }
        callback();
    }

    function normalizeSkillGroup(type) {
        let skills = currentCharacter[type];
        for (let i = 0; i < skills.length; i++) {
            skills[i].value -= editorSkillBonuses[type];
            if (skills[i].value < 0)
                skills[i].value = 0;
        }
    }

    document.getElementById('editor-points').addEventListener('focusout', function (event) {
        calculateFreePoints();
    });
    document.getElementById('editor-points').addEventListener('mouseup', function (event) {
        calculateFreePoints();
    });
    document.getElementById('editor-points').addEventListener('change', function (event) {
        calculateFreePoints();
    });
    document.getElementById('editor-points').addEventListener('keyup', function (event) {
        calculateFreePoints();
    });

    function calculateFreePoints() {
        let points = getGivenPoints() - calculateOccupiedPoints();
        $('#editor-points-left').val(points.toString());
        return points;
    }

    function getGivenPoints() {
        let points = parseInt($('#editor-points').val());
        if (!points || isNaN(points))
            points = 0;
        return points;
    }

    function calculateOccupiedPoints() {
        return calculateOccupiedPointsForSkill("actSkills")
            + calculateOccupiedPointsForSkill("knowledgeSkills")
            + calculateOccupiedPointsForSkill("socialSkills");
    }

    function calculateOccupiedPointsForSkill(type) {
        let points = 0;
        for (let i = 0; i < 10; i++) {
            let point = currentCharacter[type][i].value - editorSkillBonuses[type];
            if (point < 0) point = 0;
            points += point;
        }
        return points;
    }

    function resetCharacterEditor() {
        editorSkillBonuses = {
            actSkills: 0,
            knowledgeSkills: 0,
            socialSkills: 0
        };
        editorSkillControls = {
            actSkills: [],
            knowledgeSkills: [],
            socialSkills: []
        };
        $('#editor-name').val("");
        $('#editor-age').val("");
        $('#editor-gender').val("def");
        $('#editor-martialstatus').val("ledig");
        $('#editor-religion').val("");
        $('#editor-job').val("");
        $('#editor-stature').val("");
        currentCharacter = {
            name: "",
            age: 0,
            xp: 0,
            gender: "divers",
            health: 100,
            stature: "",
            religion: "",
            job: "",
            pointsLeft: 0,
            martialStatus: "",
            inventory: "",
            notes: "",
            actSkills: [],
            knowledgeSkills: [],
            socialSkills: []
        };
        resetSkills("actSkills", 0);
        resetSkills("knowledgeSkills", 1);
        resetSkills("socialSkills", 2);
        $('#editor-inventory').val("");
        $('#editor-notes').val("");
        $('#editor-points').val("400");
        calculateFreePoints();
    }

    function resetSkills(type, category) {
        $(`#editor-${type}-bonus`).html("0");
        $(`#editor-${type}-brainstorm`).html("0");
        for (let i = 0; i < 10; i++) {
            currentCharacter[type][i] = {
                category: category,
                name: "",
                value: 0
            };
            let name = $(`#editor-${type}-${i}-name`);
            name.data("bypass", "1");
            name.val("");
            let value = $(`#editor-${type}-${i}-value`);
            value.data("bypass", "1");
            value.val("0");
            $(`#editor-${type}-${i}-calc`).val("");
            editorSkillControls[type].push({
                name: `editor-${type}-${i}-name`,
                value: `editor-${type}-${i}-value`,
                calc: `editor-${type}-${i}-calc`
            });
        }
    }

    function initSkills(type) {
        for (let i = 0; i < 10; i++) {
            let element = document.getElementById(`editor-${type}-${i}-value`);
            element.addEventListener('focusout', (event) => {
                onEditorSkillsValueChange(`editor-${type}-${i}-value`, type, i);
            });
            element.min = 0;
        }
    }

    function onEditorSkillsValueChange(id, type, i) {
        let value = document.getElementById(id);
        let last = parseInt(value.dataset.last);
        if (!last || isNaN(last)) last = 0;
        if (value.dataset.bypass === "1") {
            value.dataset.bypass = "0";
            calculateFreePoints();
            return;
        }
        let val = parseInt(value.value);
        if (!val || isNaN(val)) val = 0;
        if (last < val) {
            if (calculateFreePoints() - val < 0) {
                value.dataset.bypass = "1";
                value.value = last.toString();
                currentCharacter[type][i].value = last;
                calculateFreePoints();
                return;
            }
        }
        value.dataset.last = val.toString();
        currentCharacter[type][i].value = val;
        recalculateSkills(type);
        calculateFreePoints();
    }

    function onEditorSkillsNameChange(id, type, i) {
        let name = document.getElementById(id);
        if (name.dataset.bypass === "1") {
            name.dataset.bypass = "0";
            return;
        }
        currentCharacter[type][i].name = name.value.trim();
    }

    $('#editor-points-refresh').click(() => {
        recalculateSkills("actSkills");
        recalculateSkills("knowledgeSkills");
        recalculateSkills("socialSkills");
    });

    function recalculateSkills(type) {
        let skillControls = editorSkillControls[type];
        let bonus = 0;
        for (let i = 0; i < skillControls.length; i++) {
            let skillControl = skillControls[i];
            if (currentCharacter[type][i].name.trim().length <= 0) {
                currentCharacter[type][i].value = 0;
                document.getElementById(skillControl.value).value = "0";
                document.getElementById(skillControl.calc).value = "0";
                continue;
            }
            let val = parseInt(document.getElementById(skillControl.value).value);
            currentCharacter[type][i].value = val;
            if (!val || isNaN(val)) {
                document.getElementById(skillControl.value).value = "0";
                val = 0;
            }
            bonus += val;
        }
        bonus = Math.round(bonus / 10);
        editorSkillBonuses[type] = bonus;
        for (let i = 0; i < skillControls.length; i++) {
            let skillControl = skillControls[i];
            if (currentCharacter[type][i].name.trim().length <= 0) continue;
            let val = parseInt(document.getElementById(skillControl.value).value);
            if (!val || isNaN(val)) {
                document.getElementById(skillControl.value).value = "0";
                val = 0;
            }
            currentCharacter[type][i].value = val;
            document.getElementById(skillControl.calc).value = (val + bonus).toString();
            currentCharacter[type][i].value = (val + bonus);
        }
        let flash = Math.round(bonus / 10);
        $('#editor-' + type + '-bonus').html(bonus.toString());
        $('#editor-' + type + '-brainstorm').html(flash.toString());
    }

    resetCharacterEditor();
    initSkills("actSkills");
    initSkills("knowledgeSkills");
    initSkills("socialSkills");
</script>
<script>
    let loginName = null;
    let characters = [];
    let sessions = [];
    let localCharacters = [];

    function editCharacter(idx, isLocal) {
        deselectCurrentPage();
        selectCharacter((isLocal ? localCharacters : characters)[idx], isLocal, idx);
    }

    function transferCharacter(idx) {
        $('#loader').show();
        let character = localCharacters[idx];
        let lastId = character.uuid;
        character.uuid = generateCharId();
        bridge.transferCharacter(lastId, JSON.stringify(character), loginName, (success) => {
            $('#loader').hide();
            if (success) {
                localCharacters.splice(idx, 1);
                updateLocalCharacters();
                characters.push(character);
                updateRemoteCharacters();
                Swal.fire({
                    icon: 'success',
                    title: 'Juhu!',
                    text: 'Dein Charakter ist nun sicher in unserer Cloud! :)',
                });
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Upsi!',
                    text: 'Leider konnten wir deinen Charakter nicht übertragen! Kein Sorge, dein Charakter bleibt sicher!',
                });
            }
        });
    }

    function updateLocalCharacters() {
        let q = $('#dashboard-local-chars');
        q.html("");
        if (localCharacters.length == 0) {
            q.append(`<tr class="has-text-centered is-fullwidth">
                        <td class="has-text-centered"><small style="color: rgba(0, 0, 0, 0.4); font-style: italic; font-size: 12px">Hier ist nichts zu sehen :(</small></td>
                    </tr>`);
        } else {
            for (let i = 0; i < localCharacters.length; i++) {
                q.append(generateCharacter(i, localCharacters[i], true));
            }
        }
    }

    function updateRemoteCharacters() {
        if (isLoggedIn())
            $('#dashboard-remote-char-pack').show();
        else
            $('#dashboard-remote-char-pack').hide();
        let q = $('#dashboard-remote-chars');
        q.html("");
        if (characters.length == 0) {
            q.append(`<tr class="has-text-centered is-fullwidth">
                        <td class="has-text-centered"><small style="color: rgba(0, 0, 0, 0.4); font-style: italic; font-size: 12px">Hier ist nichts zu sehen :(</small></td>
                    </tr>`);
        } else {
            for (let i = 0; i < characters.length; i++) {
                q.append(generateCharacter(i, characters[i], false));
            }
        }
    }

    function generateCharacter(idx, character, isLocal) {
        let upload = "";
        if (isLocal && isOnline && isLoggedIn()) {
            upload = `<button class="button is-small" onclick="transferCharacter(${idx})">
                        <span class="icon is-small">
                          <i class="fas fa-cloud-upload-alt"></i>
                        </span>
                      </button>`;
        }
        let rawString = `${character.name} (${character.gender}; ${character.age}yo; ${character.job})`;
        let strippedString = rawString;
        if (strippedString.length > 65) {
            strippedString = strippedString.substr(0, 65) + "...";
        }
        return `<tr title="${rawString}">
                    <td width="5%"><i class="fas fa-users-cog"></i></td>
                    <td>${strippedString}</td>
                    <td class="level-right">
                        ${upload}
                        <a class="button is-small is-success" href="#" onclick="editCharacter(${idx}, ${isLocal})">Ansehen / Editieren</a>
                    </td>
                </tr>`;
    }

    function emitLocalCharacters(json) {
        localCharacters = JSON.parse(json);
        updateLocalCharacters();
    }

    function isLoggedIn() {
        return loginName != null;
    }
</script>
<script>
    function showLoginPage() {
        deselectCurrentPage();
        let q = $('#page-login');
        q.show();
        currentPage = {
            content: q,
            switch: null
        };
    }

    function showRegisterPage() {
        deselectCurrentPage();
        let q = $('#page-register');
        q.show();
        currentPage = {
            content: q,
            switch: null
        };
    }

    function autoLogin(username, password) {
        interactionLocked = true;
        $('#login-finish').prop("disabled", true);
        bridge.loginUser(false, username, password, json => {
            interactionLocked = false;
            $('#login-finish').prop("disabled", false);
            if (json === null || json.trim().length <= 0) {
                Swal.fire({
                    icon: 'error',
                    title: 'Huch?',
                    text: 'Wir konnten dich leider nicht automatisch einloggen!',
                });
            } else {
                let arr = JSON.parse(json.split('\\"').join('"'));
                characters = arr[0];
                sessions = arr[1];
                let sessionObjs = arr[2];
                for (let i = 0; i < sessions.length; i++) {
                    sessions[i].sessionObj = sessionObjs[i];
                }
                loginName = username;
                $('#login-message').hide();
                updateRemoteCharacters();
                updateLocalCharacters();
                $('#login-password').val("");
                $('#login-name').val("");
                $('#sessions-list-title').show();
                updateSessions();
                $('#sessions-list').show();
                selectPage("dashboard");
                if (autoSessionJoin != null) {
                    joinSpecificSession(autoSessionJoin.id, autoSessionJoin.pw);
                    autoSessionJoin = null;
                }
                Swal.fire({
                    icon: 'success',
                    title: 'Juhu!',
                    text: 'Supi, du wurdest eingeloggt!',
                });
            }
        });
    }

    function finishLogin() {
        let username = $('#login-name').val();
        let password = $('#login-password').val();
        interactionLocked = true;
        $('#login-finish').prop("disabled", true);
        bridge.loginUser(true, username, password, json => {
            interactionLocked = false;
            $('#login-finish').prop("disabled", false);
            if (json === null || json.trim().length <= 0) {
                Swal.fire({
                    icon: 'error',
                    title: 'Öhm... Vertippt?',
                    text: 'Wir konnten leider kein Account in unserem System bei den angegebenen Daten finden!',
                });
            } else {
                let arr = JSON.parse(json.split('\\"').join('"'));
                characters = arr[0];
                sessions = arr[1];
                let sessionObjs = arr[2];
                for (let i = 0; i < sessions.length; i++) {
                    sessions[i].sessionObj = sessionObjs[i];
                }
                loginName = username;
                $('#login-message').hide();
                updateRemoteCharacters();
                updateLocalCharacters();
                $('#login-password').val("");
                $('#login-name').val("");
                selectPage("dashboard");
                if (document.getElementById('login-save').checked)
                    bridge.saveLogin(username, password);
                $('#sessions-list-title').show();
                updateSessions();
                $('#sessions-list').show();
                if (autoSessionJoin != null) {
                    joinSpecificSession(autoSessionJoin.id, autoSessionJoin.pw);
                    autoSessionJoin = null;
                }
                Swal.fire({
                    icon: 'success',
                    title: 'Juhu!',
                    text: 'Supi, du wurdest eingeloggt!',
                });
            }
        });
    }

    function updateSessions() {
        $('#sessions-list').html("");
        for (let i = 0; i < sessions.length; i++) {
            let session = sessions[i];
            appendSession(session, i);
        }
    }

    function appendSession(session, i) {
        $('#sessions-list').append(`<li><a id="session-switch-${session.session}" onclick="selectSession(${i})">${session.sessionName}</a></li>`);
    }

    function finishRegister() {
        resetRegisterFormFails();
        let username = $('#register-name').val();
        let password = $('#register-password').val();
        let repeat = $('#register-password-repeat').val();
        if (password !== repeat) {
            $('#register-password-repeat').addClass('is-danger');
            $('#register-password-failed').show();
            return;
        }
        interactionLocked = true;
        $('#register-finish').prop("disabled", true);
        bridge.registerUser(username, password, status => {
            resetRegisterFormFails();
            interactionLocked = false;
            $('#register-finish').prop("disabled", false);
            if (status === 0) {
                $('#register-name').val("");
                $('#register-password').val("");
                $('#register-password-repeat').val("");
                showLoginPage();
                Swal.fire({
                    icon: 'success',
                    title: 'Juhu! Willkommen!',
                    text: 'Dein Account wurde erfolgreich erstellt!',
                });
            } else if (status === 1) {
                $('#register-name').addClass('is-danger');
                $('#register-name-icon').addClass('fas fa-exclamation-triangle');
                $('#register-name-fail').show();
            } else if (status === 2) {
                Swal.fire({
                    icon: 'error',
                    title: 'Das war so nicht geplant...',
                    text: 'Leider ist ein interner Server aufgetreten! Bitte versuche es später erneut oder melde dich beim Support!',
                });
            }
        });
    }

    function resetRegisterFormFails() {
        $('#register-name').removeClass('is-danger');
        $('#register-name-icon').removeClass('fas fa-check fa-exclamation-triangle');
        $('#register-name-fail').hide();
        $('#register-password-repeat').removeClass('is-danger');
        $('#register-password-failed').hide();
    }

    function showRegisterAdvantages() {
        Swal.fire({
            title: "Deine Vorteile:",
            html: `<ul><li>- Freier Charakter-Cloud-Speicher</li><li>- Synchroniserung von Charakteren</li><li>- Spielleiter-Modus</li></ul>`
        });
    }
</script>
<script>
    let currentPage = null;
    let pages = {};
    let interactionLocked = false;

    $('.page-switch').each(function () {
        let q = $(this);
        let pageName = q.data("page");
        if (pageName) {
            pages[pageName] = {
                content: $('#page-' + pageName),
                switch: q
            };
            q.click(function () {
                if (interactionLocked) return;
                selectPage(pageName);
            });
        }
    })

    function selectPage(pageName) {
        deselectCurrentPage();
        currentPage = pages[pageName];
        currentPage.switch.addClass('is-active');
        currentPage.content.show();
    }

    function deselectCurrentPage() {
        if (currentPage) {
            if (currentPage.switch)
                currentPage.switch.removeClass('is-active');
            currentPage.content.hide();
        }
    }

    selectPage("dashboard");
</script>
<script>
    let isOnline;

    function switchMode(online, autoLogin) {
        isOnline = online;
        if (isOnline) {
            if (!isLoggedIn() && !autoLogin)
                $('#login-message').show();
        } else {
            $('#dashboard-remote-char-pack').hide();
            $('#login-message').hide();
            $('#sessions-list-title').hide();
            $('#sessions-list').hide();
            $('#sessions-list').html("");
        }
    }

    switchMode(false);
</script>
<script>
    function notify(text, duration, gradient) {
        Toastify({
            text: text,
            duration: duration,
            close: true,
            backgroundColor: gradient
        }).showToast();
    }

    function notifySuccess(text, duration) {
        duration = duration || 3000;
        notify(text, duration, "linear-gradient(to right, #00b09b, #96c93d)");
    }

    function notifyError(text, duration) {
        duration = duration || 5000;
        notify(text, duration, "linear-gradient(to right, #ff5f6d, #ffc371)");
    }

    function uuidv4() {
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
            const r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
        });
    }

    $('.external').each(function () {
        let q = $(this);
        q.click(function (e) {
            e.preventDefault();
            let url = q.attr("href");
            bridge.openExternalUrl(url);
        });
    });
</script>
<script>
    function applyChangelog(version, summary, content, author, date) {
        let umlauts = (raw) => {
            return raw.split('sz').join('ß').split('oe').join('ö').split('ae').join('ä').split('uee').join('ü');
        };
        $('#about-version').html(umlauts("Aktuelle Version: " + version));
        $('#about-summary').html(umlauts(summary.split("\n").join("<br>")));
        $('#about-author').html(umlauts("− " + author + " am " + date));
        $('#about-changes').html(umlauts(content.split("\n").join("<br>")));
    }

    function setSettings(json) {
        let settings = JSON.parse(json);
        if (settings.AutoStart)
            $('#settings-autostart').prop("checked", true);
        if (settings.StartMinimize)
            $('#settings-startmini').prop("checked", true);
        if (settings.MinimizeToTray)
            $('#settings-minitray').prop("checked", true);
    }

    $('#settings-logout').click(() => {
        if (!loginName) return;
        bridge.logout();
        characters = [];
        $('#sessions-list-title').hide();
        $('#sessions-list').hide();
        $('#sessions-list').html("");
        loginName = null;
        $('#login-message').show();
        updateRemoteCharacters();
        Swal.fire({
            icon: 'success',
            title: 'Tschüss!',
            text: 'Du bist nun ausgeloggt! Bis bald.',
        });
    });

    $('#settings-autostart').change(function () {
        let checked = $(this).is(":checked");
        bridge.updateSettingsBool("autostart", checked);
    });

    $('#settings-minitray').change(function () {
        let checked = $(this).is(":checked");
        bridge.updateSettingsBool("minitray", checked);
    });

    $('#settings-startmini').change(function () {
        let checked = $(this).is(":checked");
        bridge.updateSettingsBool("startmini", checked);
    });
</script>
<script>
    let autoSessionJoin = null;

    function applySessionCharDataSync(sessionId, key, json, charId) {
        let character = null;
        for (let i = 0; i < sessions.length; i++) {
            let session = sessions[i]
            if (session.session == sessionId) {
                if (session.sessionObj) {
                    for (let j = 0; j < session.sessionObj.players.length; j++) {
                        let player = session.sessionObj.players[j];
                        if (!player.character) continue;
                        if (player.character.uuid == charId) {
                            character = player.character;
                            break;
                        }
                    }
                } else {
                    character = session.character;
                }
                break;
            }
        }
        if (character == null) return;
        let val = JSON.parse(json);
        character[key] = val;
        if (!selectedCharacter || selectedCharacter.uuid != character.uuid) return;
        $('#viewer-' + key).val(val);
    }

    function applyCharDataSync(charId, key, json) {
        let character = findCharacterById(charId);
        let val = JSON.parse(json);
        character[key] = val;
        updateRemoteCharacters();
        if (!selectedCharacter || selectedCharacter.uuid != character.uuid) return;
        $('#viewer-' + key).val(val);
    }

    function applySessionCharSkillsSync(sessionId, json, charId) {
        let character = null;
        for (let i = 0; i < sessions.length; i++) {
            let session = sessions[i]
            if (session.session == sessionId) {
                if (session.sessionObj) {
                    for (let j = 0; j < session.sessionObj.players.length; j++) {
                        if (session.sessionObj.players[j].uuid == charId) {
                            character = session.sessionObj.players[j].character;
                            break;
                        }
                    }
                } else {
                    character = session.character;
                }
                break;
            }
        }
        if (character == null) return;
        let newSkills = JSON.parse(json);
        for (let i = 0; i < newSkills.length; i++) {
            let newSkill = newSkills[i];
            let skill = character[newSkill.type][newSkill.idx];
            skill.name = newSkill.name;
            skill.value = newSkill.val;
        }
        if (!selectedCharacter || selectedCharacter.uuid != character.uuid) return;
        fillCharSkillsInView("actSkills");
        fillCharSkillsInView("socialSkills");
        fillCharSkillsInView("knowledgeSkills");
    }

    function applyCharSkillsSync(charId, json) {
        let character = findCharacterById(charId);
        let newSkills = JSON.parse(json);
        for (let i = 0; i < newSkills.length; i++) {
            let newSkill = newSkills[i];
            let skill = character[newSkill.type][newSkill.idx];
            skill.name = newSkill.name;
            skill.value = newSkill.val;
        }
        if (!selectedCharacter || selectedCharacter.uuid != character.uuid) return;
        fillCharSkillsInView("actSkills");
        fillCharSkillsInView("socialSkills");
        fillCharSkillsInView("knowledgeSkills");
        updateRemoteCharacters();
    }

    function applySessionJoinSync(sessionId, json) {
        for (let i = 0; i < sessions.length; i++) {
            let session = sessions[i];
            if (session.session == sessionId) {
                let sessionUser = JSON.parse(json);
                session.sessionObj.players.push(sessionUser);
                appendSessionPlayer(i, session.sessionObj.players.length - 1);
                break;
            }
        }
    }

    function applyCharCreationSync(json) {
        let character = JSON.parse(json);
        characters.push(character);
        updateRemoteCharacters();
    }

    function applyCharDeletionSync(charId) {
        let charIdx = findCharacterIdxById(charId);
        if (charIdx != -1) {
            characters.splice(charIdx, 1);
            updateRemoteCharacters();
            if (selectedCharacter && selectedCharacter.uuid == charId) {
                $('#level-modal').removeClass('is-active');
                selectPage("dashboard");
            }
        }
    }

    function applySessionKick(sessionId) {
        let idx = -1;
        for (let i = 0; i < sessions.length; i++) {
            if (sessions[i].session == sessionId) {
                idx = i;
                break;
            }
        }
        if (idx != -1) {
            sessions.splice(idx, 1);
            updateSessions();
        }
        if (currentSession.session == sessionId) {
            currentSession = null;
            selectPage("dashboard");
        }
    }

    function applyAutoSessionJoin(json) {
        if (json.trim().length <= 0) return;
        autoSessionJoin = JSON.parse(json);
    }

    $('#refresh-characters').click(() => {
        $('#loader').show();
        bridge.refreshCharacters(loginName, charactersJson => {
            $('#loader').hide();
            if (charactersJson != "") {
                characters = JSON.parse(charactersJson.split('\\"').join('"'));
                updateRemoteCharacters();
            }
        });
    });

    window.addEventListener('keydown', function (e) {
        if (e.ctrlKey && e.shiftKey && e.altKey && e.key === "P") {
            bridge.showDevtools();
        }
    });
</script>
</body>
</html>